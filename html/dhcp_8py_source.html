<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PythonDHCP: dhcp.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PythonDHCP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dhcp_8py_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">dhcp.py</div></div>
</div><!--header-->
<div class="contents">
<a href="dhcp_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno"><a class="line" href="namespacedhcp.html">    1</a></span><span class="comment">#!/usr/bin/env python3</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="keyword">from</span> os.path <span class="keyword">import</span> exists</div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="keyword">import</span> re</div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">from</span> ttldict <span class="keyword">import</span>  TTLOrderedDict</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">import</span> socketserver</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="keyword">import</span> time</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="keyword">import</span> threading</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="keyword">import</span> struct</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="keyword">import</span> queue</div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="keyword">import</span> collections</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="keyword">import</span> traceback</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="keyword">import</span> random</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="keyword">import</span> socket</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="keyword">import</span> heapq    </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="keyword">import</span> sys</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="keyword">from</span> listener <span class="keyword">import</span> *</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="classdhcp_1_1_transaction_delay_worker.html">   20</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_transaction_delay_worker.html">TransactionDelayWorker</a>(object):</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    <span class="stringliteral">&quot;&quot;&quot;Class used to delay response to DHCP client</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="classdhcp_1_1_transaction_delay_worker.html#a6db48dc0f86e3fa546936d02ec8ed2b8">   23</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_transaction_delay_worker.html#a6db48dc0f86e3fa546936d02ec8ed2b8">__init__</a>(self):</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>        <span class="stringliteral">&quot;&quot;&quot;class constructor internally using priority queue where priority is time</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="classdhcp_1_1_transaction_delay_worker.html#a88b591aba959ea71f576bd27c3c23f41">   26</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a88b591aba959ea71f576bd27c3c23f41">closed</a> = </span><span class="keyword">False</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="classdhcp_1_1_transaction_delay_worker.html#a06c68f50041b6e9e949c6e87fe1d370b">   27</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a06c68f50041b6e9e949c6e87fe1d370b">queue</a> = <a class="code hl_class" href="classdhcp_1_1_priority_queue.html">PriorityQueue</a>()</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="classdhcp_1_1_transaction_delay_worker.html#acccc4ffe57c17795cba2691c3759fcd8">   28</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#acccc4ffe57c17795cba2691c3759fcd8">thread</a> = threading.Thread(target = self.<a class="code hl_function" href="classdhcp_1_1_transaction_delay_worker.html#a7994f56d4451c2c7880ecbcb13297ef7">_delay_response_thread</a>)</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>        self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#acccc4ffe57c17795cba2691c3759fcd8">thread</a>.start()</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    <span class="keyword">def </span>_delay_response_thread(self):</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>        <span class="stringliteral">&quot;&quot;&quot;thread worker</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="stringliteral">        </span><span class="keywordflow">while</span> <span class="keywordflow">not</span> self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a88b591aba959ea71f576bd27c3c23f41">closed</a>:</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>            <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a88b591aba959ea71f576bd27c3c23f41">closed</a>:</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>                <span class="keywordflow">break</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>            <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a06c68f50041b6e9e949c6e87fe1d370b">queue</a>.qsize() &gt; 0:</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>                p = self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a06c68f50041b6e9e949c6e87fe1d370b">queue</a>.get()</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>                t, func, args, kw = p</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>                now = time.time()</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>                <span class="keywordflow">if</span> now &lt; t:</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>                    time.sleep(0.01)</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>                    self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a06c68f50041b6e9e949c6e87fe1d370b">queue</a>.put(p)</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>                    func(*args, **kw)</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="classdhcp_1_1_transaction_delay_worker.html#a2581fd14007f440528591686e05a6f36">   48</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_transaction_delay_worker.html#a2581fd14007f440528591686e05a6f36">do_after</a>(self, seconds, func, args = (), kw = {}):</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        <span class="stringliteral">&quot;&quot;&quot;Add to queue function which should be called after certain time</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="stringliteral">        specified by seconds, args, kw are arguments</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a06c68f50041b6e9e949c6e87fe1d370b">queue</a>.put((time.time() + seconds, func, args, kw))</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="classdhcp_1_1_transaction_delay_worker.html#ab46086ae177f9f76c790277c8dc09f9b">   54</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_transaction_delay_worker.html#ab46086ae177f9f76c790277c8dc09f9b">close</a>(self):</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>        <span class="stringliteral">&quot;&quot;&quot;Method used to stop worker</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_transaction_delay_worker.html#a88b591aba959ea71f576bd27c3c23f41">closed</a> = </span><span class="keyword">True</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="namespacedhcp.html#af20880fd0c047e3357f1c8c239968538">   59</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacedhcp.html#af20880fd0c047e3357f1c8c239968538">get_host_ip_addresses</a>():</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="stringliteral">&quot;&quot;&quot;Get IP address of current host.</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="stringliteral">    </span><span class="keywordflow">return</span> gethostbyname_ex(gethostname())[2]</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="classdhcp_1_1_priority_queue.html">   64</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_priority_queue.html">PriorityQueue</a>(object):</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="stringliteral">&quot;&quot;&quot;This class contains Heapq for more information:</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="stringliteral">    https://docs.python.org/3/library/heapq.html</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="classdhcp_1_1_priority_queue.html#a790eb940b494728bc6753ddf3febc513">   68</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_priority_queue.html#a790eb940b494728bc6753ddf3febc513">__init__</a>(self):</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        self.<a class="code hl_variable" href="classdhcp_1_1_priority_queue.html#a6a52ec70f226bbb5c32ab8ac85dbad95">_queue</a> = []</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        self.<a class="code hl_variable" href="classdhcp_1_1_priority_queue.html#a784952c04d9144e3d1521b377609daee">_index</a> = 0</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="classdhcp_1_1_priority_queue.html#afd1fdf4e96d3c3dde2a05113e161728c">   72</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_priority_queue.html#afd1fdf4e96d3c3dde2a05113e161728c">put</a>(self, item):</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        heapq.heappush(self.<a class="code hl_variable" href="classdhcp_1_1_priority_queue.html#a6a52ec70f226bbb5c32ab8ac85dbad95">_queue</a>, (self.<a class="code hl_variable" href="classdhcp_1_1_priority_queue.html#a784952c04d9144e3d1521b377609daee">_index</a>, item))</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        self.<a class="code hl_variable" href="classdhcp_1_1_priority_queue.html#a784952c04d9144e3d1521b377609daee">_index</a> += 1</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno"><a class="line" href="classdhcp_1_1_priority_queue.html#ac1073e720d4edd4f4eb220e86421bc9d">   76</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_priority_queue.html#ac1073e720d4edd4f4eb220e86421bc9d">get</a>(self):</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="keywordflow">return</span> heapq.heappop(self.<a class="code hl_variable" href="classdhcp_1_1_priority_queue.html#a6a52ec70f226bbb5c32ab8ac85dbad95">_queue</a>)[-1]</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="classdhcp_1_1_priority_queue.html#af0f906a4edcc884001a82593805432b1">   79</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_priority_queue.html#af0f906a4edcc884001a82593805432b1">qsize</a>(self):</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>        <span class="keywordflow">return</span> len(self.<a class="code hl_variable" href="classdhcp_1_1_priority_queue.html#a6a52ec70f226bbb5c32ab8ac85dbad95">_queue</a>)</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html">   82</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_write_boot_protocol_packet.html">WriteBootProtocolPacket</a>(object):</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="stringliteral">&quot;&quot;&quot;DHCP protocol datagram serializer</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="stringliteral">    This </span><span class="keyword">class </span>serializes UDP DHCP <a class="code hl_variable" href="namespacelistener.html#a5bccea4f84af3a2a57917ff10a721736">packet</a>, instance is constructed using global </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    configuration <span class="keyword">from</span> which dhcp options are copied</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a7c1eaf3ea98ff19558a2873d47c1bd13">   87</a></span><span class="stringliteral">    message_type = 2 </span><span class="comment"># 1 for client -&gt; server 2 for server -&gt; client</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#ae995d022d4c4280c10036f64b271d455">   88</a></span>    hardware_type = 1</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a5e78e0ac4f0a7e322a479567bf0ab43c">   89</a></span>    hardware_address_length = 6</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a49c598b664e64b515f80d6f29637e003">   90</a></span>    hops = 0</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#add8bca1f53869d801f62ff51f38ef315">   92</a></span>    transaction_id = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a34a75a9fd48929777c6730460b577344">   94</a></span>    seconds_elapsed = 0</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a2158cd33033b3ad7b3de5fd0ced0747d">   95</a></span>    bootp_flags = 0 <span class="comment"># unicast</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a7c5041840cc7b7f15970bf58be486659">   97</a></span>    client_ip_address = <span class="stringliteral">&#39;0.0.0.0&#39;</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#abed6f8fcad62c89ae9f670dd8ce95987">   98</a></span>    your_ip_address = <span class="stringliteral">&#39;0.0.0.0&#39;</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a58a23d7668a529c7e9216228c4cf2ba1">   99</a></span>    next_server_ip_address = <span class="stringliteral">&#39;0.0.0.0&#39;</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#aec59dbba94aedab6025226cb7bf92682">  100</a></span>    relay_agent_ip_address = <span class="stringliteral">&#39;0.0.0.0&#39;</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a8dadba279ad323c2986da9c8822664ff">  102</a></span>    client_mac_address = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#ab5a5b6937a48e0daa4aae992a247f2d5">  103</a></span>    magic_cookie = <span class="stringliteral">&#39;99.130.83.99&#39;</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a7833e353ff7adc5f1b8042fcd739c7cd">  105</a></span>    parameter_order = []</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a04195f0af2bc134ac398a11227af4b16">  107</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#a04195f0af2bc134ac398a11227af4b16">__init__</a>(self, configuration):</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        <span class="stringliteral">&quot;&quot;&quot;Create new packet instance and search for options set in configuration </span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="stringliteral">        </span><span class="keywordflow">and</span> copy them tgo packet</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="stringliteral">        </span><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(256):</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>            names = [<span class="stringliteral">&#39;option_{}&#39;</span>.format(i)]</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>            <span class="keywordflow">if</span> i &lt; len(options) <span class="keywordflow">and</span> hasattr(configuration, options[i][0]):</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                names.append(options[i][0])</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            <span class="keywordflow">for</span> name <span class="keywordflow">in</span> names:</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                <span class="keywordflow">if</span> hasattr(configuration, name):</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                    setattr(self, name, getattr(configuration, name))</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#af902569db8f9c77b0b0bbbbb66c5f98f">  119</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#af902569db8f9c77b0b0bbbbb66c5f98f">to_bytes</a>(self):</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <span class="stringliteral">&quot;&quot;&quot;Serialize UDP DHCP response packet to bytes</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="stringliteral">        result = bytearray(236)</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="stringliteral">        </span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="stringliteral">        result[0] = self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a7c1eaf3ea98ff19558a2873d47c1bd13">message_type</a></span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="stringliteral">        result[1] = self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#ae995d022d4c4280c10036f64b271d455">hardware_type</a></span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><span class="stringliteral">        result[2] = self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a5e78e0ac4f0a7e322a479567bf0ab43c">hardware_address_length</a></span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span><span class="stringliteral">        result[3] = self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a49c598b664e64b515f80d6f29637e003">hops</a></span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><span class="stringliteral">        result[4:8] = struct.pack(&#39;&gt;I&#39;</span>, self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#add8bca1f53869d801f62ff51f38ef315">transaction_id</a>)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        result[ 8:10] = <a class="code hl_variable" href="namespacelistener.html#a36ceadb1f7f70fbe13b1d40358555d7a">shortpack</a>(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a34a75a9fd48929777c6730460b577344">seconds_elapsed</a>)</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>        result[10:12] = <a class="code hl_variable" href="namespacelistener.html#a36ceadb1f7f70fbe13b1d40358555d7a">shortpack</a>(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a2158cd33033b3ad7b3de5fd0ced0747d">bootp_flags</a>)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        result[12:16] = inet_aton(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a7c5041840cc7b7f15970bf58be486659">client_ip_address</a>)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        result[16:20] = inet_aton(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#abed6f8fcad62c89ae9f670dd8ce95987">your_ip_address</a>)</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        result[20:24] = inet_aton(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a58a23d7668a529c7e9216228c4cf2ba1">next_server_ip_address</a>)</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        result[24:28] = inet_aton(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#aec59dbba94aedab6025226cb7bf92682">relay_agent_ip_address</a>)</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        result[28:28 + self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a5e78e0ac4f0a7e322a479567bf0ab43c">hardware_address_length</a>] = <a class="code hl_function" href="namespacelistener.html#a15fb8066ece6d815dde7ba6cdb823d57">macpack</a>(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a8dadba279ad323c2986da9c8822664ff">client_mac_address</a>)</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        </div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        result += inet_aton(self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#ab5a5b6937a48e0daa4aae992a247f2d5">magic_cookie</a>)</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        <span class="keywordflow">for</span> option <span class="keywordflow">in</span> self.<a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#a1eb459ed259bff6617085971eb31361c">options</a>:</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>            value = self.<a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#aab5d8b775b053559511c06cf52949670">get_option</a>(option)</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>            <span class="comment">#print(option, value)</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            <span class="keywordflow">if</span> value <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>                <span class="keywordflow">continue</span></div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>            result += bytes([option, len(value)]) + value</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        result += bytes([255])</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        <span class="keywordflow">return</span> bytes(result)</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#aab5d8b775b053559511c06cf52949670">  152</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#aab5d8b775b053559511c06cf52949670">get_option</a>(self, option):</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        <span class="stringliteral">&quot;&quot;&quot;Get DHCP UDP response packet option value</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="stringliteral">        </span><span class="keywordflow">if</span> option &lt; len(options) <span class="keywordflow">and</span> hasattr(self, options[option][0]):</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            value = getattr(self, options[option][0])</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        <span class="keywordflow">elif</span> hasattr(self, <span class="stringliteral">&#39;option_{}&#39;</span>.format(option)):</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>            value = getattr(self, <span class="stringliteral">&#39;option_{}&#39;</span>.format(option))</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        function = options[option][2]</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        <span class="keywordflow">if</span> function <span class="keywordflow">and</span> value <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            value = function(value)</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        <span class="keywordflow">return</span> value</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="preprocessor">@property</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#a1eb459ed259bff6617085971eb31361c">  167</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#a1eb459ed259bff6617085971eb31361c">options</a>(self):</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        <span class="stringliteral">&quot;&quot;&quot;Get DHCP UDP response packet option value</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="stringliteral">        done = list()</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span><span class="stringliteral">        </span><span class="comment"># fulfill wishes</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        <span class="keywordflow">for</span> option <span class="keywordflow">in</span> self.<a class="code hl_variable" href="classdhcp_1_1_write_boot_protocol_packet.html#a7833e353ff7adc5f1b8042fcd739c7cd">parameter_order</a>:</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>            <span class="keywordflow">if</span> option &lt; len(options) <span class="keywordflow">and</span> hasattr(self, options[option][0]) <span class="keywordflow">or</span> hasattr(self, <span class="stringliteral">&#39;option_{}&#39;</span>.format(option)):</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                <span class="comment"># this may break with the specification because we must try to fulfill the wishes</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                <span class="keywordflow">if</span> option <span class="keywordflow">not</span> <span class="keywordflow">in</span> done:</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                    done.append(option)</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <span class="comment"># add my stuff</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        <span class="keywordflow">for</span> option, o <span class="keywordflow">in</span> enumerate(options):</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>            <span class="keywordflow">if</span> o[0] <span class="keywordflow">and</span> hasattr(self, o[0]):</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                <span class="keywordflow">if</span> option <span class="keywordflow">not</span> <span class="keywordflow">in</span> done:</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                    done.append(option)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>        <span class="keywordflow">for</span> option <span class="keywordflow">in</span> range(256):</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            <span class="keywordflow">if</span> hasattr(self, <span class="stringliteral">&#39;option_{}&#39;</span>.format(option)):</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                <span class="keywordflow">if</span> option <span class="keywordflow">not</span> <span class="keywordflow">in</span> done:</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                    done.append(option)</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        <span class="keywordflow">return</span> done</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno"><a class="line" href="classdhcp_1_1_write_boot_protocol_packet.html#aea12de4e76f8ea2b8c4eb33f4adac9c4">  188</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#aea12de4e76f8ea2b8c4eb33f4adac9c4">__str__</a>(self):</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        <span class="stringliteral">&quot;&quot;&quot;Serialize UDP DHCP response packet to bytes</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="stringliteral">        </span><span class="keywordflow">return</span> str(<a class="code hl_class" href="classlistener_1_1_read_boot_protocol_packet.html">ReadBootProtocolPacket</a>(self.<a class="code hl_function" href="classdhcp_1_1_write_boot_protocol_packet.html#af902569db8f9c77b0b0bbbbb66c5f98f">to_bytes</a>()))</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html">  193</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_d_h_c_p_transaction.html">DHCPTransaction</a>(object):</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="stringliteral">&quot;&quot;&quot;Class representing DHCP Transaction</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#aa6b4d1ca986f35009cc226a6b33f1334">  196</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#aa6b4d1ca986f35009cc226a6b33f1334">__init__</a>(self, server):</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        <span class="stringliteral">&quot;&quot;&quot;Contructor of new transaction</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">  199</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a> = server</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">  200</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a> = server.configuration</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#ab34941515e9c6acbb985aeef4b26c20f">  201</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ab34941515e9c6acbb985aeef4b26c20f">packets</a> = []</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a816612f54eb1d0f9b6281c06f00442b7">  202</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a816612f54eb1d0f9b6281c06f00442b7">done_time</a> = time.time() + self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.length_of_transaction</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a9b45fff7092b26fce7b3275c015ba4bf">  203</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a9b45fff7092b26fce7b3275c015ba4bf">done</a> = </span><span class="keyword">False</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#af4c5e3b25264df622a86463f2a581e41">  204</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#af4c5e3b25264df622a86463f2a581e41">do_after</a> = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a>.delay_worker.do_after</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">  205</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">debug</a> = debug</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#af53ca7186575ad528aa4a0698fd9cbb7">  207</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#af53ca7186575ad528aa4a0698fd9cbb7">is_done</a>(self):</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        <span class="stringliteral">&quot;&quot;&quot;Check if transaction is done </span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span><span class="stringliteral">        </span><span class="keywordflow">return</span> self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a9b45fff7092b26fce7b3275c015ba4bf">done</a> <span class="keywordflow">or</span> self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a816612f54eb1d0f9b6281c06f00442b7">done_time</a> &lt; time.time()</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a3ed98b3b86d150574fa4f89e8932050b">  212</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a3ed98b3b86d150574fa4f89e8932050b">close</a>(self):</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="stringliteral">&quot;&quot;&quot;Close transaction</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a9b45fff7092b26fce7b3275c015ba4bf">done</a> = </span><span class="keyword">True</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#aae31911f51f293161e55bcb8b2053f01">  217</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#aae31911f51f293161e55bcb8b2053f01">receive</a>(self, packet):</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        <span class="stringliteral">&quot;&quot;&quot;Receive DHCP UDP packet check it&#39;s type and call a proper callback</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="stringliteral">        </span><span class="comment"># packet from client &lt;-&gt; packet.message_type == 1</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="keywordflow">if</span> packet.message_type == 1 <span class="keywordflow">and</span> packet.dhcp_message_type == <span class="stringliteral">&#39;DHCPDISCOVER&#39;</span>:</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#af4c5e3b25264df622a86463f2a581e41">do_after</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.dhcp_offer_after_seconds,</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>                          self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a01f7133e90ff9e9f4171156043e97d24">received_dhcp_discover</a>, (packet,), )</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        <span class="keywordflow">elif</span> packet.message_type == 1 <span class="keywordflow">and</span> packet.dhcp_message_type == <span class="stringliteral">&#39;DHCPREQUEST&#39;</span>:</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#af4c5e3b25264df622a86463f2a581e41">do_after</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.dhcp_acknowledge_after_seconds,</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                          self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a597990e446406ab5b466873cb26d3401">received_dhcp_request</a>, (packet,), )</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        <span class="keywordflow">elif</span> packet.message_type == 1 <span class="keywordflow">and</span> packet.dhcp_message_type == <span class="stringliteral">&#39;DHCPINFORM&#39;</span>:</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a688bb4dff2fdd13482813e0d4daf0519">received_dhcp_inform</a>(packet)</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a01f7133e90ff9e9f4171156043e97d24">  233</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a01f7133e90ff9e9f4171156043e97d24">received_dhcp_discover</a>(self, discovery):</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        <span class="stringliteral">&quot;&quot;&quot;Method used to handle DHCP Discover packet</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="stringliteral">        </span><span class="keywordflow">if</span> self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#af53ca7186575ad528aa4a0698fd9cbb7">is_done</a>(): <span class="keywordflow">return</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">debug</a>(<span class="stringliteral">&#39;discover:\n {}&#39;</span>.format(str(discovery).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a3902197353a4c20c0dcac8526f78135c">send_offer</a>(discovery)</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a3902197353a4c20c0dcac8526f78135c">  240</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a3902197353a4c20c0dcac8526f78135c">send_offer</a>(self, discovery):</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        <span class="stringliteral">&quot;&quot;&quot;Method used to send DHCP offer packet</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="stringliteral">        </span><span class="comment"># https://tools.ietf.org/html/rfc2131</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        offer = <a class="code hl_class" href="classdhcp_1_1_write_boot_protocol_packet.html">WriteBootProtocolPacket</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>)</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        offer.parameter_order = discovery.parameter_request_list</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        mac = discovery.client_mac_address</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        ip = offer.your_ip_address = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a>.get_ip_address(discovery)</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <span class="comment"># offer.client_ip_address = </span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        offer.transaction_id = discovery.transaction_id</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        <span class="comment"># offer.next_server_ip_address =</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        offer.relay_agent_ip_address = discovery.relay_agent_ip_address</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        offer.client_mac_address = mac</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        offer.client_ip_address = discovery.client_ip_address <span class="keywordflow">or</span> <span class="stringliteral">&#39;0.0.0.0&#39;</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        offer.bootp_flags = discovery.bootp_flags</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        offer.dhcp_message_type = <span class="stringliteral">&#39;DHCPOFFER&#39;</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        offer.client_identifier = mac</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">debug</a>(<span class="stringliteral">&#39;offer:\n {}&#39;</span>.format(str(offer).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a>.broadcast(offer)</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a597990e446406ab5b466873cb26d3401">  260</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a597990e446406ab5b466873cb26d3401">received_dhcp_request</a>(self, request):</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <span class="stringliteral">&quot;&quot;&quot;Method used to handle DHCP Request packet</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="stringliteral">        </span><span class="keywordflow">if</span> self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#af53ca7186575ad528aa4a0698fd9cbb7">is_done</a>(): <span class="keywordflow">return</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">debug</a>(<span class="stringliteral">&#39;request:\n {}&#39;</span>.format(str(request).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a>.client_has_chosen(request)</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a84787d49ed1d39194315546d1b203be1">acknowledge</a>(request)</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a3ed98b3b86d150574fa4f89e8932050b">close</a>()</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a84787d49ed1d39194315546d1b203be1">  269</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a84787d49ed1d39194315546d1b203be1">acknowledge</a>(self, request):</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>        <span class="stringliteral">&quot;&quot;&quot;Method used to handle DHCP Acknowledge packet</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span><span class="stringliteral">        ack = <a class="code hl_class" href="classdhcp_1_1_write_boot_protocol_packet.html">WriteBootProtocolPacket</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>)</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="stringliteral">        ack.parameter_order = request.parameter_request_list</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span><span class="stringliteral">        ack.transaction_id = request.transaction_id</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span><span class="stringliteral">        </span><span class="comment"># ack.next_server_ip_address =</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        ack.bootp_flags = request.bootp_flags</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        ack.relay_agent_ip_address = request.relay_agent_ip_address</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        mac = request.client_mac_address</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        ack.client_mac_address = mac</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        requested_ip_address = request.requested_ip_address</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        ack.client_ip_address = request.client_ip_address <span class="keywordflow">or</span> <span class="stringliteral">&#39;0.0.0.0&#39;</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        ack.your_ip_address = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a>.get_ip_address(request)</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        ack.dhcp_message_type = <span class="stringliteral">&#39;DHCPACK&#39;</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">debug</a>(<span class="stringliteral">&#39;acknowledge:\n {}&#39;</span>.format(str(ack).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a>.broadcast(ack)</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_transaction.html#a688bb4dff2fdd13482813e0d4daf0519">  287</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a688bb4dff2fdd13482813e0d4daf0519">received_dhcp_inform</a>(self, inform):</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        <span class="stringliteral">&quot;&quot;&quot;Method used to handle DHCP Inform packet</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">configuration</a>.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">debug</a>(&#39;inform:\n {}&#39;</span>.format(str(inform).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_transaction.html#a3ed98b3b86d150574fa4f89e8932050b">close</a>()</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">server</a>.client_has_chosen(inform)</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html">  294</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_d_h_c_p_server_configuration.html">DHCPServerConfiguration</a>(object):</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="stringliteral">&quot;&quot;&quot;Class to load DHCP server configuration from file or command line</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8e86611b3ea41d75f9d0ac7010edbc5f">  297</a></span><span class="stringliteral">    dhcp_offer_after_seconds = 10</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a3237c2a7ad2a15e2ed260960fe04eafc">  298</a></span><span class="stringliteral">    dhcp_acknowledge_after_seconds = 10</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a3d224e886f43ae665f010cdaf09546a9">  299</a></span><span class="stringliteral">    length_of_transaction = 40</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8ec5462f74c8fa19621e0c4d0edfb843">  301</a></span><span class="stringliteral">    network = &#39;192.168.173.0&#39;</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#aa58cf42f87609209ddce0173b45322c9">  302</a></span>    broadcast_address = <span class="stringliteral">&#39;255.255.255.255&#39;</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a4296295b495ecc82f6646516017ff2cc">  303</a></span>    subnet_mask = <span class="stringliteral">&#39;255.255.255.0&#39;</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a55b1c1ae7a00c76da1ed7ce2a1f12bf9">  304</a></span>    router = <span class="keywordtype">None</span> <span class="comment"># list of ips</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <span class="comment"># 1 day is 86400</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#aa32aa9798ca8bda68d0a251fda995440">  306</a></span>    ip_address_lease_time = 300 <span class="comment"># seconds</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8dfb7835e513433b9ec1bb29f380e34a">  307</a></span>    domain_name_server = <span class="keywordtype">None</span> <span class="comment"># list of ips</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8e7b3b6cdecb88a5355ae33e7b829a46">  309</a></span>    host_file = <span class="stringliteral">&#39;hosts.csv&#39;</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a74cb330547f34b82e62afaf10e75478e">  311</a></span>    debug = <span class="keyword">lambda</span> *args, **kw: <span class="keywordtype">None</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a180484ac4bdf23fc07407d3b44f722cc">  313</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a180484ac4bdf23fc07407d3b44f722cc">load</a>(self, file):</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="stringliteral">&quot;&quot;&quot;Load configuration from file using exec to parse file as object dictionary</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="stringliteral">        </span><span class="keywordflow">or</span> get ALL command line arguments <span class="keywordflow">and</span> change them using regexp to file layout</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        <span class="keywordflow">and</span> treat <span class="keyword">as</span> file</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span><span class="stringliteral">        if(len(file) &gt; 0 </span><span class="keywordflow">and</span> exists(file)):</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            <span class="keyword">with</span> open(file) <span class="keyword">as</span> f:</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>                exec(f.read(), self.__dict__)</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            args = <span class="stringliteral">&#39; &#39;</span>.join(sys.argv[1:])</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>            args = re.sub(<span class="stringliteral">&#39; -&#39;</span>, <span class="stringliteral">&quot;\r\n&quot;</span>, args)</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            args = re.sub(<span class="stringliteral">&#39;^-&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, args)</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            args = re.sub(<span class="stringliteral">&#39;^([a-z_]+)([ ]+)(.+)$&#39;</span>, <span class="stringliteral">r&quot;\1=\3&quot;</span>, args, flags=re.MULTILINE)</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            exec(args, self.__dict__)</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a7a5fc60105c8d57601ec948d7d43c8fa">  328</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a7a5fc60105c8d57601ec948d7d43c8fa">adjust_if_this_computer_is_a_router</a>(self):</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        <span class="stringliteral">&quot;&quot;&quot;Automatically adjust some DHCP configuration parameters if this computer is router</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="stringliteral">        ip_addresses = <a class="code hl_function" href="namespacedhcp.html#af20880fd0c047e3357f1c8c239968538">get_host_ip_addresses</a>()</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="stringliteral">        </span><span class="keywordflow">for</span> ip <span class="keywordflow">in</span> reversed(ip_addresses):</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            <span class="keywordflow">if</span> ip.split(<span class="stringliteral">&#39;.&#39;</span>)[-1] == <span class="stringliteral">&#39;1&#39;</span>:</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>                self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a55b1c1ae7a00c76da1ed7ce2a1f12bf9">router</a> = [ip]</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>                self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8dfb7835e513433b9ec1bb29f380e34a">domain_name_server</a> = [ip]</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#ad55c5454a6b02e892124f9ef3e3617ab">  336</a></span>                self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8ec5462f74c8fa19621e0c4d0edfb843">network</a><a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#ad55c5454a6b02e892124f9ef3e3617ab">network</a> = <span class="stringliteral">&#39;.&#39;</span>.join(ip.split(<span class="stringliteral">&#39;.&#39;</span>)[:-1] + [<span class="stringliteral">&#39;0&#39;</span>])</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a314df3b0d50a13968153f317cfac2ee2">  337</a></span>                self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#aa58cf42f87609209ddce0173b45322c9">broadcast_address</a><a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a314df3b0d50a13968153f317cfac2ee2">broadcast_address</a> = <span class="stringliteral">&#39;.&#39;</span>.join(ip.split(<span class="stringliteral">&#39;.&#39;</span>)[:-1] + [<span class="stringliteral">&#39;255&#39;</span>])</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>                <span class="comment">#self.ip_forwarding_enabled = True</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>                <span class="comment">#self.non_local_source_routing_enabled = True</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>                <span class="comment">#self.perform_mask_discovery = True</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a59a4bfcf49842e7453ba71412d7e9abf">  342</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a59a4bfcf49842e7453ba71412d7e9abf">all_ip_addresses</a>(self):</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        ips = <a class="code hl_function" href="namespacedhcp.html#ab060cad3f10abaad7ad33123c5118aea">ip_addresses</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8ec5462f74c8fa19621e0c4d0edfb843">network</a><a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#ad55c5454a6b02e892124f9ef3e3617ab">network</a>, self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a4296295b495ecc82f6646516017ff2cc">subnet_mask</a>)</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(5):</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>            next(ips)</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        <span class="keywordflow">return</span> ips</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server_configuration.html#aa1e71c8f12e8968a8da7a5779da19f7c">  348</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server_configuration.html#aa1e71c8f12e8968a8da7a5779da19f7c">network_filter</a>(self):</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classdhcp_1_1_n_e_t_w_o_r_k.html">NETWORK</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8ec5462f74c8fa19621e0c4d0edfb843">network</a><a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#ad55c5454a6b02e892124f9ef3e3617ab">network</a>, self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server_configuration.html#a4296295b495ecc82f6646516017ff2cc">subnet_mask</a>)</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno"><a class="line" href="namespacedhcp.html#ab060cad3f10abaad7ad33123c5118aea">  351</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacedhcp.html#ab060cad3f10abaad7ad33123c5118aea">ip_addresses</a>(network, subnet_mask):</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="keyword">import</span> socket, struct</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    subnet_mask = struct.unpack(<span class="stringliteral">&#39;&gt;I&#39;</span>, socket.inet_aton(subnet_mask))[0]</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    network = struct.unpack(<span class="stringliteral">&#39;&gt;I&#39;</span>, socket.inet_aton(network))[0]</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    network = network &amp; subnet_mask</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    start = network + 1</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    end = (network | (~subnet_mask &amp; 0xffffffff))</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="keywordflow">return</span> (socket.inet_ntoa(struct.pack(<span class="stringliteral">&#39;&gt;I&#39;</span>, i)) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(start, end))</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno"><a class="line" href="classdhcp_1_1_a_l_l.html">  360</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_a_l_l.html">ALL</a>(object):</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    <span class="stringliteral">&quot;&quot;&quot;Comparator class</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno"><a class="line" href="classdhcp_1_1_a_l_l.html#a2decb7f5204c7f5c975e1b0feccab3f4">  363</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_a_l_l.html#a2decb7f5204c7f5c975e1b0feccab3f4">__eq__</a>(self, other):</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno"><a class="line" href="classdhcp_1_1_a_l_l.html#abe30d795d1074c9eeae934f5dc74b97b">  365</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_a_l_l.html#abe30d795d1074c9eeae934f5dc74b97b">__repr__</a>(self):</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        <span class="keywordflow">return</span> self.__class__.__name__</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a7dc1828cff0a85a56ca25ead41044324">  368</a></span>ALL = <a class="code hl_class" href="classdhcp_1_1_a_l_l.html">ALL</a>()</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno"><a class="line" href="classdhcp_1_1_g_r_e_a_t_e_r.html">  370</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_g_r_e_a_t_e_r.html">GREATER</a>(object):</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="stringliteral">&quot;&quot;&quot;Comparator class</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno"><a class="line" href="classdhcp_1_1_g_r_e_a_t_e_r.html#a6c283efcaf3815abb7121061f45b4332">  373</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_g_r_e_a_t_e_r.html#a6c283efcaf3815abb7121061f45b4332">__init__</a>(self, value):</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno"><a class="line" href="classdhcp_1_1_g_r_e_a_t_e_r.html#ac340b80531a5e54d8ad03059c41c4906">  374</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_g_r_e_a_t_e_r.html#ac340b80531a5e54d8ad03059c41c4906">value</a> = value</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno"><a class="line" href="classdhcp_1_1_g_r_e_a_t_e_r.html#a904d88008338389f183032d0e996f3c1">  375</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_g_r_e_a_t_e_r.html#a904d88008338389f183032d0e996f3c1">__eq__</a>(self, other):</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        <span class="keywordflow">return</span> type(self.<a class="code hl_variable" href="classdhcp_1_1_g_r_e_a_t_e_r.html#ac340b80531a5e54d8ad03059c41c4906">value</a>)(other) &gt; self.<a class="code hl_variable" href="classdhcp_1_1_g_r_e_a_t_e_r.html#ac340b80531a5e54d8ad03059c41c4906">value</a></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno"><a class="line" href="classdhcp_1_1_n_e_t_w_o_r_k.html">  378</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_n_e_t_w_o_r_k.html">NETWORK</a>(object):</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="stringliteral">&quot;&quot;&quot;Comparator class to check if address within same network</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno"><a class="line" href="classdhcp_1_1_n_e_t_w_o_r_k.html#aad7fdb6b11bad9cb44e9d35b00e97631">  381</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_n_e_t_w_o_r_k.html#aad7fdb6b11bad9cb44e9d35b00e97631">__init__</a>(self, network, subnet_mask):</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno"><a class="line" href="classdhcp_1_1_n_e_t_w_o_r_k.html#af96eacbe29f44b963ba8e1553b9a5412">  382</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_n_e_t_w_o_r_k.html#af96eacbe29f44b963ba8e1553b9a5412">subnet_mask</a> = struct.unpack(<span class="stringliteral">&#39;&gt;I&#39;</span>, inet_aton(subnet_mask))[0]</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno"><a class="line" href="classdhcp_1_1_n_e_t_w_o_r_k.html#a0389879d6d5493763fd15a6a6c18a73d">  383</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_n_e_t_w_o_r_k.html#a0389879d6d5493763fd15a6a6c18a73d">network</a> = struct.unpack(<span class="stringliteral">&#39;&gt;I&#39;</span>, inet_aton(network))[0]</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno"><a class="line" href="classdhcp_1_1_n_e_t_w_o_r_k.html#ab2aa1dd0d3ed83f1eb87deadc60f200f">  384</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_n_e_t_w_o_r_k.html#ab2aa1dd0d3ed83f1eb87deadc60f200f">__eq__</a>(self, other):</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        ip = struct.unpack(<span class="stringliteral">&#39;&gt;I&#39;</span>, inet_aton(other))[0]</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>        <span class="keywordflow">return</span> ip &amp; self.<a class="code hl_variable" href="classdhcp_1_1_n_e_t_w_o_r_k.html#af96eacbe29f44b963ba8e1553b9a5412">subnet_mask</a> == self.<a class="code hl_variable" href="classdhcp_1_1_n_e_t_w_o_r_k.html#a0389879d6d5493763fd15a6a6c18a73d">network</a> <span class="keywordflow">and</span> \</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>               ip - self.<a class="code hl_variable" href="classdhcp_1_1_n_e_t_w_o_r_k.html#a0389879d6d5493763fd15a6a6c18a73d">network</a> <span class="keywordflow">and</span> \</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>               ip - self.<a class="code hl_variable" href="classdhcp_1_1_n_e_t_w_o_r_k.html#a0389879d6d5493763fd15a6a6c18a73d">network</a> != ~self.<a class="code hl_variable" href="classdhcp_1_1_n_e_t_w_o_r_k.html#af96eacbe29f44b963ba8e1553b9a5412">subnet_mask</a> &amp; 0xffffffff</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html">  390</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html">CASEINSENSITIVE</a>(object):</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <span class="stringliteral">&quot;&quot;&quot;Comparator class</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#a4ce239988cab4ee26e3ae2f2373d4502">  393</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#a4ce239988cab4ee26e3ae2f2373d4502">__init__</a>(self, s):</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#abf08fca05bbe0b19153e9ddb27b56528">  394</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#abf08fca05bbe0b19153e9ddb27b56528">s</a> = s.lower()</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#ad51c9059a0928e7d6fb9fc770ddbe7c2">  395</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#ad51c9059a0928e7d6fb9fc770ddbe7c2">__eq__</a>(self, other):</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>        <span class="keywordflow">return</span> self.<a class="code hl_variable" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#abf08fca05bbe0b19153e9ddb27b56528">s</a> == other.lower()</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html">  398</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_c_s_v_database.html">CSVDatabase</a>(object):</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <span class="stringliteral">&quot;&quot;&quot;Class handling CSV file database to keep host definitions</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#a6c415d72358e6ba6abc2459662a7bdb9">  401</a></span><span class="stringliteral">    delimiter = &#39;;&#39;</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#ac81f0160bc47f0d0b09027654dad7b92">  403</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#ac81f0160bc47f0d0b09027654dad7b92">__init__</a>(self, file_name):</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <span class="stringliteral">&quot;&quot;&quot;Construct new CSV database with storage in file_name</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#a4c64356172f2f54a7d2d16214316b8ab">  406</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_c_s_v_database.html#a4c64356172f2f54a7d2d16214316b8ab">file_name</a> = file_name</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span><span class="stringliteral">        self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#afe747abe2434e051adb3f2d682a716d5">file</a>(&#39;a&#39;</span>).close() <span class="comment"># create file</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#afe747abe2434e051adb3f2d682a716d5">  409</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#afe747abe2434e051adb3f2d682a716d5">file</a>(self, mode = &#39;r&#39;):</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>        <span class="stringliteral">&quot;&quot;&quot;Open CSV file with selected mode</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span><span class="stringliteral">        </span><span class="keywordflow">return</span> open(self.<a class="code hl_variable" href="classdhcp_1_1_c_s_v_database.html#a4c64356172f2f54a7d2d16214316b8ab">file_name</a>, mode)</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span> </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#aa88bd3c0e526c7ee639669d0079f3650">  414</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#aa88bd3c0e526c7ee639669d0079f3650">get</a>(self, pattern):</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        <span class="stringliteral">&quot;&quot;&quot;Get CSV entry representing host(MAC) and lease(IP)</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="stringliteral">        pattern = list(pattern)</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span><span class="stringliteral">        </span><span class="keywordflow">return</span> [line <span class="keywordflow">for</span> line <span class="keywordflow">in</span> self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#a6d9ec1ae037c871dc49185433b00f19c">all</a>() <span class="keywordflow">if</span> pattern == line]</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#a869e6011c293c4c68df9ba689aab151a">  420</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#a869e6011c293c4c68df9ba689aab151a">add</a>(self, line):</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        <span class="stringliteral">&quot;&quot;&quot;Add host entry to CSV file</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span><span class="stringliteral">        </span><span class="keyword">with</span> self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#afe747abe2434e051adb3f2d682a716d5">file</a>(<span class="stringliteral">&#39;a&#39;</span>) <span class="keyword">as</span> f:</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            f.write(self.<a class="code hl_variable" href="classdhcp_1_1_c_s_v_database.html#a6c415d72358e6ba6abc2459662a7bdb9">delimiter</a>.join(line) + <span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#adf3ffd96793b19b52fe679b3ce318f2e">  426</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#adf3ffd96793b19b52fe679b3ce318f2e">delete</a>(self, pattern):</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <span class="stringliteral">&quot;&quot;&quot;Delete host entry from CSV file</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span><span class="stringliteral">        lines = self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#a6d9ec1ae037c871dc49185433b00f19c">all</a>()</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span><span class="stringliteral">        lines_to_delete = self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#aa88bd3c0e526c7ee639669d0079f3650">get</a>(pattern)</span></div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span><span class="stringliteral">        self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#afe747abe2434e051adb3f2d682a716d5">file</a>(&#39;w&#39;</span>).close() <span class="comment"># empty file</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>        <span class="keywordflow">for</span> line <span class="keywordflow">in</span> lines:</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            <span class="keywordflow">if</span> line <span class="keywordflow">not</span> <span class="keywordflow">in</span> lines_to_delete:</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#a869e6011c293c4c68df9ba689aab151a">add</a>(line)</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno"><a class="line" href="classdhcp_1_1_c_s_v_database.html#a6d9ec1ae037c871dc49185433b00f19c">  436</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#a6d9ec1ae037c871dc49185433b00f19c">all</a>(self):</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        <span class="stringliteral">&quot;&quot;&quot;Get all entries from CSV file</span></div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span><span class="stringliteral">        </span><span class="keyword">with</span> self.<a class="code hl_function" href="classdhcp_1_1_c_s_v_database.html#afe747abe2434e051adb3f2d682a716d5">file</a>() <span class="keyword">as</span> f:</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>            <span class="keywordflow">return</span> [list(line.strip().split(self.<a class="code hl_variable" href="classdhcp_1_1_c_s_v_database.html#a6c415d72358e6ba6abc2459662a7bdb9">delimiter</a>)) <span class="keywordflow">for</span> line <span class="keywordflow">in</span> f]</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html">  442</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_host.html">Host</a>(object):</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="stringliteral">&quot;&quot;&quot;Class representing host with MAC address, IP, hostname if available and last used timestamp</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#ab0ad131caf3688fda7ec3246d3a919aa">  445</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#ab0ad131caf3688fda7ec3246d3a919aa">__init__</a>(self, mac, ip, hostname, last_used):</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#aabc84008d42981a5c7c2e8322bd8b5f4">  446</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aabc84008d42981a5c7c2e8322bd8b5f4">mac</a> = mac.upper()</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#aecf59068c5829a6fc9bfe52f35a33391">  447</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aecf59068c5829a6fc9bfe52f35a33391">ip</a> = ip</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#a4db1cd4ba6cae9480967587ed4b26b95">  448</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_host.html#a4db1cd4ba6cae9480967587ed4b26b95">hostname</a> = hostname</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#aee6d734c3a4608ebc899f14efce36ff0">  449</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aee6d734c3a4608ebc899f14efce36ff0">last_used</a> = int(last_used)</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="preprocessor">@classmethod</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#a45ba91c0afcceeb3a7a3370aab91dc0f">  452</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#a45ba91c0afcceeb3a7a3370aab91dc0f">from_tuple</a>(cls, line):</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>        mac, ip, hostname, last_used = line</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>        last_used = int(last_used)</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>        <span class="keywordflow">return</span> cls(mac, ip, hostname, last_used)</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <span class="preprocessor">@classmethod</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#a65e90f26bd53e4484d53f82b0b8b3bc8">  458</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#a65e90f26bd53e4484d53f82b0b8b3bc8">from_packet</a>(cls, packet):</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="keywordflow">return</span> cls(packet.client_mac_address,</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>                   packet.requested_ip_address <span class="keywordflow">or</span> packet.client_ip_address,</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>                   packet.host_name <span class="keywordflow">or</span> <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>                   int(time.time()))</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="preprocessor">@staticmethod</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#a90055429ec7c36129ea44d6f9e2f45a7">  465</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#a90055429ec7c36129ea44d6f9e2f45a7">get_pattern</a>(mac = ALL, ip = ALL, hostname = ALL, last_used = ALL):</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        <span class="keywordflow">return</span> [mac, ip, hostname, last_used]</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#af4101aa3d505fb12742083f2268b0aaa">  468</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#af4101aa3d505fb12742083f2268b0aaa">to_tuple</a>(self):</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <span class="stringliteral">&quot;&quot;&quot;Convert host to tuple</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span><span class="stringliteral">        </span><span class="keywordflow">return</span> [self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aabc84008d42981a5c7c2e8322bd8b5f4">mac</a>, self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aecf59068c5829a6fc9bfe52f35a33391">ip</a>, self.<a class="code hl_variable" href="classdhcp_1_1_host.html#a4db1cd4ba6cae9480967587ed4b26b95">hostname</a>, str(int(self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aee6d734c3a4608ebc899f14efce36ff0">last_used</a>))]</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#a700da84969feda66ac68f7214fa3b113">  473</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#a700da84969feda66ac68f7214fa3b113">to_pattern</a>(self):</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <span class="stringliteral">&quot;&quot;&quot;Convert host to pattern</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span><span class="stringliteral">        </span><span class="keywordflow">return</span> self.<a class="code hl_function" href="classdhcp_1_1_host.html#a90055429ec7c36129ea44d6f9e2f45a7">get_pattern</a>(ip = self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aecf59068c5829a6fc9bfe52f35a33391">ip</a>, mac = self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aabc84008d42981a5c7c2e8322bd8b5f4">mac</a>)</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#a221af5247505072a9ca2223025377756">  478</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#a221af5247505072a9ca2223025377756">__hash__</a>(self):</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <span class="keywordflow">return</span> hash(self.key)</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#adcf88164490fe575a9f220d3b37d5fff">  481</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#adcf88164490fe575a9f220d3b37d5fff">__eq__</a>(self, other):</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        <span class="keywordflow">return</span> self.<a class="code hl_function" href="classdhcp_1_1_host.html#af4101aa3d505fb12742083f2268b0aaa">to_tuple</a>() == other.to_tuple()</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host.html#a287287e62149143af68711e7c1617282">  484</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host.html#a287287e62149143af68711e7c1617282">has_valid_ip</a>(self):</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>        <span class="stringliteral">&quot;&quot;&quot;Check if host has valid IP address</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="stringliteral">        </span><span class="keywordflow">return</span> self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aecf59068c5829a6fc9bfe52f35a33391">ip</a> <span class="keywordflow">and</span> self.<a class="code hl_variable" href="classdhcp_1_1_host.html#aecf59068c5829a6fc9bfe52f35a33391">ip</a> != <span class="stringliteral">&#39;0.0.0.0&#39;</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html">  489</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_host_database.html">HostDatabase</a>(object):</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html#aaf801ca6318cd6092aff4564e22665f0">  490</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host_database.html#aaf801ca6318cd6092aff4564e22665f0">__init__</a>(self, file_name):</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html#ad10f58a0a7ec720fbf530c9b0fb98058">  491</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_host_database.html#ad10f58a0a7ec720fbf530c9b0fb98058">db</a> = <a class="code hl_class" href="classdhcp_1_1_c_s_v_database.html">CSVDatabase</a>(file_name)</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html#a392bba3af76de29a6bf8314c15fb298e">  493</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host_database.html#a392bba3af76de29a6bf8314c15fb298e">get</a>(self, **kw):</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        pattern = Host.get_pattern(**kw)</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        <span class="keywordflow">return</span> list(map(Host.from_tuple, self.<a class="code hl_variable" href="classdhcp_1_1_host_database.html#ad10f58a0a7ec720fbf530c9b0fb98058">db</a>.<a class="code hl_function" href="classdhcp_1_1_host_database.html#a392bba3af76de29a6bf8314c15fb298e">get</a>(pattern)))</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html#afbf9e7255243735d446d69da9ad01b95">  497</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host_database.html#afbf9e7255243735d446d69da9ad01b95">add</a>(self, host):</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>        self.<a class="code hl_variable" href="classdhcp_1_1_host_database.html#ad10f58a0a7ec720fbf530c9b0fb98058">db</a>.<a class="code hl_function" href="classdhcp_1_1_host_database.html#afbf9e7255243735d446d69da9ad01b95">add</a>(host.to_tuple())</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html#a011b8b19259f5df030e3746c5f751717">  500</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host_database.html#a011b8b19259f5df030e3746c5f751717">delete</a>(self, host = None, **kw):</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>        <span class="keywordflow">if</span> host <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>            pattern = Host.get_pattern(**kw)</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>            pattern = host.to_pattern()</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        self.<a class="code hl_variable" href="classdhcp_1_1_host_database.html#ad10f58a0a7ec720fbf530c9b0fb98058">db</a>.<a class="code hl_function" href="classdhcp_1_1_host_database.html#a011b8b19259f5df030e3746c5f751717">delete</a>(pattern)</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span> </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html#a1bfeeeca3271a5e20a957d41f75be28c">  507</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host_database.html#a1bfeeeca3271a5e20a957d41f75be28c">all</a>(self):</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>        <span class="keywordflow">return</span> list(map(Host.from_tuple, self.<a class="code hl_variable" href="classdhcp_1_1_host_database.html#ad10f58a0a7ec720fbf530c9b0fb98058">db</a>.<a class="code hl_function" href="classdhcp_1_1_host_database.html#a1bfeeeca3271a5e20a957d41f75be28c">all</a>()))</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span> </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno"><a class="line" href="classdhcp_1_1_host_database.html#a54e5a7e7e3d9479470b7c3c103ea052c">  510</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_host_database.html#a54e5a7e7e3d9479470b7c3c103ea052c">replace</a>(self, host):</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>        self.<a class="code hl_function" href="classdhcp_1_1_host_database.html#a011b8b19259f5df030e3746c5f751717">delete</a>(host)</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        self.<a class="code hl_function" href="classdhcp_1_1_host_database.html#afbf9e7255243735d446d69da9ad01b95">add</a>(host)</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno"><a class="line" href="namespacedhcp.html#ab6b61de7bae0d5e51c3e4b753bc48421">  514</a></span><span class="keyword">def </span><a class="code hl_function" href="namespacedhcp.html#ab6b61de7bae0d5e51c3e4b753bc48421">sorted_hosts</a>(hosts):</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    hosts = list(hosts)</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    hosts.sort(key = <span class="keyword">lambda</span> host: (host.hostname.lower(), host.mac.lower(), host.ip.lower()))</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    <span class="keywordflow">return</span> hosts</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span> </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html">  519</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_d_h_c_p_server.html">DHCPServer</a>(object):</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    <span class="stringliteral">&quot;&quot;&quot;Main DHCP server class that is handling incoming packets and sending responses</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span><span class="stringliteral">    using all other utility classes</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#aae6fca0bb91de82b090278a45bb5634f">  523</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#aae6fca0bb91de82b090278a45bb5634f">__init__</a>(self, configuration = None):</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        <span class="keywordflow">if</span> configuration == <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            configuration = <a class="code hl_class" href="classdhcp_1_1_d_h_c_p_server_configuration.html">DHCPServerConfiguration</a>()</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>            </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">  527</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a> = configuration</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        <span class="comment">#OPEN UDP SOCKET FOR HANDLING INCOMING DHCP PACKETS and SENDING RESPONSES</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a93516cbbbd270d873698bbe13dbd3520">  529</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a93516cbbbd270d873698bbe13dbd3520">socket</a> = <a class="code hl_namespace" href="namespacesocket.html">socket</a>(type = SOCK_DGRAM)</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a93516cbbbd270d873698bbe13dbd3520">socket</a>.setsockopt(SOL_SOCKET, SO_REUSEADDR, 1)</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a93516cbbbd270d873698bbe13dbd3520">socket</a>.bind((<span class="stringliteral">&#39;&#39;</span>, 67))</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#ad0db4a8937934f994c6bf861873dc8b9">  532</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad0db4a8937934f994c6bf861873dc8b9">delay_worker</a> = <a class="code hl_class" href="classdhcp_1_1_transaction_delay_worker.html">TransactionDelayWorker</a>()</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#ac2c06166394c431fdf45fac68a95a23c">  533</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ac2c06166394c431fdf45fac68a95a23c">closed</a> = <span class="keyword">False</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a67a29068f2ed30839ae9d136abbe2c89">  534</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a67a29068f2ed30839ae9d136abbe2c89">transactions</a> = collections.defaultdict(<span class="keyword">lambda</span>: <a class="code hl_class" href="classdhcp_1_1_d_h_c_p_transaction.html">DHCPTransaction</a>(self)) <span class="comment"># id: transaction</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">  535</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">hosts</a> = <a class="code hl_class" href="classdhcp_1_1_host_database.html">HostDatabase</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.host_file)</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a29aa89ca8607f78da17e3585866c0cf9">  536</a></span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a29aa89ca8607f78da17e3585866c0cf9">time_started</a> = time.time()</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#ab35d34adc3b6c6b820eacae82dfb7361">  538</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#ab35d34adc3b6c6b820eacae82dfb7361">close</a>(self):</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a93516cbbbd270d873698bbe13dbd3520">socket</a>.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#ab35d34adc3b6c6b820eacae82dfb7361">close</a>()</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ac2c06166394c431fdf45fac68a95a23c">closed</a> = <span class="keyword">True</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad0db4a8937934f994c6bf861873dc8b9">delay_worker</a>.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#ab35d34adc3b6c6b820eacae82dfb7361">close</a>()</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="keywordflow">for</span> transaction <span class="keywordflow">in</span> list(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a67a29068f2ed30839ae9d136abbe2c89">transactions</a>.values()):</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>            transaction.close()</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a1270c39efab736e13b4645adccb5d445">  545</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a1270c39efab736e13b4645adccb5d445">update</a>(self, timeout = 0):</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>            reads = select.select([self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a93516cbbbd270d873698bbe13dbd3520">socket</a>], [], [], timeout)[0]</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>            <span class="comment"># ValueError: file descriptor cannot be a negative integer (-1)</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>            <span class="keywordflow">return</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <span class="keywordflow">for</span> socket <span class="keywordflow">in</span> reads:</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                packet = <a class="code hl_class" href="classlistener_1_1_read_boot_protocol_packet.html">ReadBootProtocolPacket</a>(*socket.recvfrom(4096))</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>            <span class="keywordflow">except</span> OSError:</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                <span class="comment"># OSError: [WinError 10038] An operation was attempted on something that is not a socket</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                <span class="keywordflow">pass</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>                self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#ad4d593daddb6f818f3b8aa2240dc1cb5">received</a>(packet)</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        <span class="keywordflow">for</span> transaction_id, transaction <span class="keywordflow">in</span> list(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a67a29068f2ed30839ae9d136abbe2c89">transactions</a>.items()):</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>            <span class="keywordflow">if</span> transaction.is_done():</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>                transaction.close()</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>                self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a67a29068f2ed30839ae9d136abbe2c89">transactions</a>.pop(transaction_id)</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span> </div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#ad4d593daddb6f818f3b8aa2240dc1cb5">  564</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#ad4d593daddb6f818f3b8aa2240dc1cb5">received</a>(self, packet):</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a67a29068f2ed30839ae9d136abbe2c89">transactions</a>[packet.transaction_id].receive(packet):</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(<span class="stringliteral">&#39;received:\n {}&#39;</span>.format(str(packet).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>            </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a613a716546dae583db2f813414a34f2b">  568</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a613a716546dae583db2f813414a34f2b">client_has_chosen</a>(self, packet):</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(<span class="stringliteral">&#39;client_has_chosen:\n {}&#39;</span>.format(str(packet).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        host = Host.from_packet(packet)</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> host.has_valid_ip():</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>            <span class="keywordflow">return</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">hosts</a>.replace(host)</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span> </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a09717723751aecefc6ead6efb43bfe27">  575</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a09717723751aecefc6ead6efb43bfe27">is_valid_client_address</a>(self, address):</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="keywordflow">if</span> address <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        a = address.split(<span class="stringliteral">&#39;.&#39;</span>)</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        s = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.subnet_mask.split(<span class="stringliteral">&#39;.&#39;</span>)</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        n = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.network.split(<span class="stringliteral">&#39;.&#39;</span>)</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <span class="keywordflow">return</span> all(s[i] == <span class="stringliteral">&#39;0&#39;</span> <span class="keywordflow">or</span> a[i] == n[i] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(4))</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span> </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#ad0abc95458235a7300991d9111c49869">  583</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#ad0abc95458235a7300991d9111c49869">get_ip_address</a>(self, packet):</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        mac_address = packet.client_mac_address</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        requested_ip_address = packet.requested_ip_address</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        known_hosts = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">hosts</a>.get(mac = <a class="code hl_class" href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html">CASEINSENSITIVE</a>(mac_address))</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        ip = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <span class="keywordflow">if</span> known_hosts:</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            <span class="comment"># 1. choose known ip address</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            <span class="keywordflow">for</span> host <span class="keywordflow">in</span> known_hosts:</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>                <span class="keywordflow">if</span> self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a09717723751aecefc6ead6efb43bfe27">is_valid_client_address</a>(host.ip):</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                    ip = host.ip</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(<span class="stringliteral">&#39;known ip:{}&#39;</span>.format(ip))</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        <span class="keywordflow">if</span> ip <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a09717723751aecefc6ead6efb43bfe27">is_valid_client_address</a>(requested_ip_address):</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            <span class="comment"># 2. choose valid requested ip address</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>            ip = requested_ip_address</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(<span class="stringliteral">&#39;valid ip:{}&#39;</span>.format(ip))</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        <span class="keywordflow">if</span> ip <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>            <span class="comment"># 3. choose new, free ip address</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            chosen = <span class="keyword">False</span></div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>            network_hosts = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">hosts</a>.get(ip = self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.network_filter())</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            <span class="keywordflow">for</span> ip <span class="keywordflow">in</span> self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.all_ip_addresses():</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>                <span class="keywordflow">if</span> <span class="keywordflow">not</span> any(host.ip == ip <span class="keywordflow">for</span> host <span class="keywordflow">in</span> network_hosts):</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>                    chosen = <span class="keyword">True</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                    <span class="keywordflow">break</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> chosen:</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>                <span class="comment"># 4. reuse old valid ip address</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>                network_hosts.sort(key = <span class="keyword">lambda</span> host: host.last_used)</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>                ip = network_hosts[0].ip</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                <span class="keyword">assert</span> self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a09717723751aecefc6ead6efb43bfe27">is_valid_client_address</a>(ip)</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(<span class="stringliteral">&#39;new ip:&#39;</span>.format(ip))</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> any([host.ip == ip <span class="keywordflow">for</span> host <span class="keywordflow">in</span> known_hosts]):</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(<span class="stringliteral">&#39;add {} {}&#39;</span>.format(mac_address, ip, packet.host_name))</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>            self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">hosts</a>.replace(<a class="code hl_class" href="classdhcp_1_1_host.html">Host</a>(mac_address, ip, packet.host_name <span class="keywordflow">or</span> <span class="stringliteral">&#39;&#39;</span>, time.time()))</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        <span class="keywordflow">return</span> ip</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span> </div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <span class="preprocessor">@property</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a0c3ee14aec5d0474ac6cc370c5347795">  618</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a0c3ee14aec5d0474ac6cc370c5347795">server_identifiers</a>(self):</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacedhcp.html#af20880fd0c047e3357f1c8c239968538">get_host_ip_addresses</a>()</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a657300b76aa268c81976de4ffcbc0644">  621</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a657300b76aa268c81976de4ffcbc0644">broadcast</a>(self, packet):</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(<span class="stringliteral">&#39;broadcasting:\n {}&#39;</span>.format(str(packet).replace(<span class="stringliteral">&#39;\n&#39;</span>, <span class="stringliteral">&#39;\n\t&#39;</span>)))</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        <span class="keywordflow">for</span> addr <span class="keywordflow">in</span> self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a0c3ee14aec5d0474ac6cc370c5347795">server_identifiers</a>:</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>            broadcast_socket = <a class="code hl_namespace" href="namespacesocket.html">socket</a>(type = SOCK_DGRAM)</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            broadcast_socket.setsockopt(SOL_SOCKET, SO_REUSEADDR, 1)</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            broadcast_socket.setsockopt(SOL_SOCKET, SO_BROADCAST, 1)</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>            packet.server_identifier = addr</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>            broadcast_socket.bind((addr, 67))</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                data = packet.to_bytes()</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                broadcast_socket.sendto(data, (<span class="stringliteral">&#39;255.255.255.255&#39;</span>, 68))</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                broadcast_socket.sendto(data, (addr, 68))</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            <span class="keywordflow">finally</span>:</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>                broadcast_socket.close()</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#af7a2d659dc19642dbfd3838982491f53">  636</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#af7a2d659dc19642dbfd3838982491f53">run</a>(self):</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        <span class="keywordflow">while</span> <span class="keywordflow">not</span> self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ac2c06166394c431fdf45fac68a95a23c">closed</a>:</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>                self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a1270c39efab736e13b4645adccb5d445">update</a>(1)</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>            <span class="keywordflow">except</span> KeyboardInterrupt:</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>                <span class="keywordflow">break</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>            <span class="keywordflow">except</span>:</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>                traceback.print_exc()</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a60d24347513562e332a247704d0d3ff8">  645</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a60d24347513562e332a247704d0d3ff8">run_in_thread</a>(self):</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        thread = threading.Thread(target = self.<a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#af7a2d659dc19642dbfd3838982491f53">run</a>)</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>        thread.start()</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        <span class="keywordflow">return</span> thread</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#aaf1568a67cd2ba6132c412f664e72ca1">  650</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#aaf1568a67cd2ba6132c412f664e72ca1">debug_clients</a>(self):</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        <span class="keywordflow">for</span> line <span class="keywordflow">in</span> self.ips.all():</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>            line = <span class="stringliteral">&#39;\t&#39;</span>.join(line)</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>            <span class="keywordflow">if</span> line:</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>                self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">configuration</a>.<a class="code hl_variable" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">debug</a>(line)</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#a7a509c96ae764cd0bd9bd8e84ee23562">  656</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#a7a509c96ae764cd0bd9bd8e84ee23562">get_all_hosts</a>(self):</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacedhcp.html#ab6b61de7bae0d5e51c3e4b753bc48421">sorted_hosts</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">hosts</a>.get())</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno"><a class="line" href="classdhcp_1_1_d_h_c_p_server.html#ada6bcaad1d88519fd7086a442ed998e1">  659</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_d_h_c_p_server.html#ada6bcaad1d88519fd7086a442ed998e1">get_current_hosts</a>(self):</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacedhcp.html#ab6b61de7bae0d5e51c3e4b753bc48421">sorted_hosts</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">hosts</a>.get(last_used = <a class="code hl_class" href="classdhcp_1_1_g_r_e_a_t_e_r.html">GREATER</a>(self.<a class="code hl_variable" href="classdhcp_1_1_d_h_c_p_server.html#a29aa89ca8607f78da17e3585866c0cf9">time_started</a>)))</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_request_handler.html">  662</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_threaded_t_c_p_request_handler.html">ThreadedTCPRequestHandler</a>(socketserver.StreamRequestHandler):</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    <span class="stringliteral">&quot;&quot;&quot;Control socket client connection handler</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_request_handler.html#ac78a14e22d2de9aece1eb569821bed03">  665</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_threaded_t_c_p_request_handler.html#ac78a14e22d2de9aece1eb569821bed03">handle</a>(self):</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        <span class="stringliteral">&quot;&quot;&quot;Method used to handle client connection parsing commands and giving response to them</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="stringliteral">        self.request.sendall(bytes(&quot;Welcome to micro python dhcp server&quot;</span>, <span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            while(<span class="keyword">True</span>):</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                self.request.sendall(bytes(<span class="stringliteral">&quot;\r\npydhcp ?&gt; &quot;</span>, <span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                data = self.rfile.readline().strip()</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>                if(data.decode() == <span class="stringliteral">&quot;hosts&quot;</span>):</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;Active Hosts:\r\n{}&quot;</span>.format(<span class="stringliteral">&quot;\r\n&quot;</span>.join(self.server.hosts.all())),<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>                elif(data.decode() == <span class="stringliteral">&quot;events&quot;</span>):</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;Events last 24h:\r\n{}&quot;</span>.format(<span class="stringliteral">&quot;\r\n&quot;</span>.join(self.server.events.items())),<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>                elif(data.decode() == <span class="stringliteral">&quot;configuration&quot;</span>):</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;Current configuration\r\n&quot;</span>, <span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>                    <span class="keywordflow">for</span> value <span class="keywordflow">in</span> options:</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>                        if(hasattr(self.server.configuration,value[0])):</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>                            self.request.sendall(bytes(<span class="stringliteral">&quot;{}: {}\r\n&quot;</span>.format(value[0],getattr(self.server.configuration,value[0])),<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>                elif(data.decode() == <span class="stringliteral">&quot;help&quot;</span>):</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;hosts\t\tdisplay host database\r\n&quot;</span>,<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;events\t\tdisplay DHCP event log\r\n&quot;</span>,<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;configuration\tdisplay current server configuration\r\n&quot;</span>,<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;help\t\tthis command\r\n&quot;</span>,<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;quit\t\tdisconnect from current session\r\n&quot;</span>,<span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>                elif(data.decode() == <span class="stringliteral">&quot;quit&quot;</span>):</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;bye\r\n&quot;</span>, <span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>                    <span class="keywordflow">break</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                    self.request.sendall(bytes(<span class="stringliteral">&quot;unknown command: {}&quot;</span>.format(data.decode(<span class="stringliteral">&#39;ascii&#39;</span>)), <span class="stringliteral">&#39;ascii&#39;</span>))</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>            <span class="keywordflow">pass</span></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span> </div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_server.html">  696</a></span><span class="keyword">class </span><a class="code hl_class" href="classdhcp_1_1_threaded_t_c_p_server.html">ThreadedTCPServer</a>(socketserver.ThreadingMixIn, socketserver.TCPServer):</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <span class="stringliteral">&quot;&quot;&quot;DHCP server control interface TCP server</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_server.html#a298bdccf761c349e340b27db1865ac2f">  699</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_threaded_t_c_p_server.html#a298bdccf761c349e340b27db1865ac2f">setEvents</a>(self,data):</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>        <span class="stringliteral">&quot;&quot;&quot;Set DHCP events dictionary reference</span></div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_server.html#aeb5515a34e31d53dca8459bb79e034d6">  702</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_threaded_t_c_p_server.html#aeb5515a34e31d53dca8459bb79e034d6">events</a> = data</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_server.html#a00e40b47cf0258fec5fdac38fec70289">  704</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_threaded_t_c_p_server.html#a00e40b47cf0258fec5fdac38fec70289">setHosts</a>(self,data):</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>        <span class="stringliteral">&quot;&quot;&quot;Set DHCP host database with active leases reference</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_server.html#a895afba96fa627cb796c4b5a14d3f73c">  707</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_threaded_t_c_p_server.html#a895afba96fa627cb796c4b5a14d3f73c">hosts</a> = data</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span><span class="stringliteral">        </span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_server.html#ac46a680f92c5fa91de9103ba9ee4f1f1">  709</a></span><span class="stringliteral">    </span><span class="keyword">def </span><a class="code hl_function" href="classdhcp_1_1_threaded_t_c_p_server.html#ac46a680f92c5fa91de9103ba9ee4f1f1">setConfiguration</a>(self,data):</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>        <span class="stringliteral">&quot;&quot;&quot;Set DHCP UDP global configuration reference</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno"><a class="line" href="classdhcp_1_1_threaded_t_c_p_server.html#a20dc710a5b965b91777ceff69a9bbb66">  712</a></span><span class="stringliteral">        self.<a class="code hl_variable" href="classdhcp_1_1_threaded_t_c_p_server.html#a20dc710a5b965b91777ceff69a9bbb66">configuration</a> = data</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span><span class="stringliteral"></span><span class="keywordflow">if</span> __name__ == <span class="stringliteral">&quot;__main__&quot;</span>:</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a44db535f1dc6992492f6e3a9498cb87e">  716</a></span>    HOST, PORT = <span class="stringliteral">&quot;localhost&quot;</span>, 6868</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a4803c82dbc2dc819ace67a76b36fac77">  717</a></span>    messages = <a class="code hl_class" href="classttldict_1_1_t_t_l_ordered_dict.html">TTLOrderedDict</a>(default_ttl=86400) <span class="comment">#keep messages for 24h</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>    </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a601bd489973305b2dba2d3dd7ce30ed3">  719</a></span>    <span class="keyword">def </span><a class="code hl_function" href="namespacedhcp.html#a601bd489973305b2dba2d3dd7ce30ed3">debug_msg</a>(msg,type):</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>        <span class="keywordflow">if</span> bool(type):</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>            type = <span class="stringliteral">&#39;debug&#39;</span></div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>        messages[time.time()] = { <span class="stringliteral">&#39;type&#39;</span>: type, <span class="stringliteral">&#39;msg&#39;</span>: msg }</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    if(len(sys.argv) == 1):</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        print(<span class="stringliteral">&#39;configuration file or command line options must be passed&#39;</span>)</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        sys.exit()</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span> </div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno"><a class="line" href="namespacedhcp.html#ae07ac61b02b06c25a3797571b09d6b53">  728</a></span>    configuration = <a class="code hl_class" href="classdhcp_1_1_d_h_c_p_server_configuration.html">DHCPServerConfiguration</a>()</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">  729</a></span>    configuration.debug = debug_msg</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    configuration.adjust_if_this_computer_is_a_router()</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    configuration.load(sys.argv[1])</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    configuration.router <span class="comment">#+= [&#39;192.168.0.1&#39;]</span></div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno"><a class="line" href="namespacedhcp.html#ab7a91c254731d739131c23acd44cc194">  733</a></span>    configuration.ip_address_lease_time = 60</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a6c8f85562af4201baa7a635aaa66ea6c">  734</a></span>    server = <a class="code hl_class" href="classdhcp_1_1_d_h_c_p_server.html">DHCPServer</a>(configuration)</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    </div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <span class="keywordflow">for</span> ip <span class="keywordflow">in</span> server.configuration.all_ip_addresses():</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>        <span class="keyword">assert</span> ip == server.configuration.network_filter()</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a4192fc3287e87c089c12f79f8a7c1d5d">  739</a></span>    s = server.run_in_thread()</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    print(<span class="stringliteral">&quot;UDP DHCP Server loop running in thread:&quot;</span>, s.name)</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    </div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a30d680fd47a3f31137d1c1d70a818e40">  742</a></span>    cserver = <a class="code hl_class" href="classdhcp_1_1_threaded_t_c_p_server.html">ThreadedTCPServer</a>((HOST, PORT), ThreadedTCPRequestHandler)</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    <span class="keyword">with</span> cserver:</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        cserver.setEvents(messages)</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>        cserver.setHosts(server.hosts.db)</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        cserver.setConfiguration(configuration)</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>        <span class="comment"># Start a thread with the server -- that thread will then start one</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        <span class="comment"># more thread for each request</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno"><a class="line" href="namespacedhcp.html#a802cb547c9c7d3558e598dd36721c4e7">  749</a></span>        cserver_thread = threading.Thread(target=cserver.serve_forever)</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>        <span class="comment"># Exit the server thread when the main thread terminates</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno"><a class="line" href="namespacedhcp.html#aae3c666c1c35344f02551cde9d00d866">  751</a></span>        cserver_thread.daemon = <span class="keyword">True</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        cserver_thread.start()</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>        print(<span class="stringliteral">&quot;Control Server loop running in thread:&quot;</span>, cserver_thread.name)</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span> </div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>        input(<span class="stringliteral">&quot;Enter to exit&quot;</span>)</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>        cserver.shutdown()</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    </div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    server.close()</div>
<div class="ttc" id="aclassdhcp_1_1_a_l_l_html"><div class="ttname"><a href="classdhcp_1_1_a_l_l.html">dhcp.ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00360">dhcp.py:360</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_a_l_l_html_a2decb7f5204c7f5c975e1b0feccab3f4"><div class="ttname"><a href="classdhcp_1_1_a_l_l.html#a2decb7f5204c7f5c975e1b0feccab3f4">dhcp.ALL.__eq__</a></div><div class="ttdeci">def __eq__(self, other)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00363">dhcp.py:363</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_a_l_l_html_abe30d795d1074c9eeae934f5dc74b97b"><div class="ttname"><a href="classdhcp_1_1_a_l_l.html#abe30d795d1074c9eeae934f5dc74b97b">dhcp.ALL.__repr__</a></div><div class="ttdeci">def __repr__(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00365">dhcp.py:365</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e_html"><div class="ttname"><a href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html">dhcp.CASEINSENSITIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00390">dhcp.py:390</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e_html_a4ce239988cab4ee26e3ae2f2373d4502"><div class="ttname"><a href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#a4ce239988cab4ee26e3ae2f2373d4502">dhcp.CASEINSENSITIVE.__init__</a></div><div class="ttdeci">def __init__(self, s)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00393">dhcp.py:393</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e_html_abf08fca05bbe0b19153e9ddb27b56528"><div class="ttname"><a href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#abf08fca05bbe0b19153e9ddb27b56528">dhcp.CASEINSENSITIVE.s</a></div><div class="ttdeci">s</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00394">dhcp.py:394</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e_html_ad51c9059a0928e7d6fb9fc770ddbe7c2"><div class="ttname"><a href="classdhcp_1_1_c_a_s_e_i_n_s_e_n_s_i_t_i_v_e.html#ad51c9059a0928e7d6fb9fc770ddbe7c2">dhcp.CASEINSENSITIVE.__eq__</a></div><div class="ttdeci">def __eq__(self, other)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00395">dhcp.py:395</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html">dhcp.CSVDatabase</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00398">dhcp.py:398</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_a4c64356172f2f54a7d2d16214316b8ab"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#a4c64356172f2f54a7d2d16214316b8ab">dhcp.CSVDatabase.file_name</a></div><div class="ttdeci">file_name</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00406">dhcp.py:406</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_a6c415d72358e6ba6abc2459662a7bdb9"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#a6c415d72358e6ba6abc2459662a7bdb9">dhcp.CSVDatabase.delimiter</a></div><div class="ttdeci">string delimiter</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00401">dhcp.py:401</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_a6d9ec1ae037c871dc49185433b00f19c"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#a6d9ec1ae037c871dc49185433b00f19c">dhcp.CSVDatabase.all</a></div><div class="ttdeci">def all(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00436">dhcp.py:436</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_a869e6011c293c4c68df9ba689aab151a"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#a869e6011c293c4c68df9ba689aab151a">dhcp.CSVDatabase.add</a></div><div class="ttdeci">def add(self, line)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00420">dhcp.py:420</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_aa88bd3c0e526c7ee639669d0079f3650"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#aa88bd3c0e526c7ee639669d0079f3650">dhcp.CSVDatabase.get</a></div><div class="ttdeci">def get(self, pattern)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00414">dhcp.py:414</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_ac81f0160bc47f0d0b09027654dad7b92"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#ac81f0160bc47f0d0b09027654dad7b92">dhcp.CSVDatabase.__init__</a></div><div class="ttdeci">def __init__(self, file_name)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00403">dhcp.py:403</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_adf3ffd96793b19b52fe679b3ce318f2e"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#adf3ffd96793b19b52fe679b3ce318f2e">dhcp.CSVDatabase.delete</a></div><div class="ttdeci">def delete(self, pattern)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00426">dhcp.py:426</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_c_s_v_database_html_afe747abe2434e051adb3f2d682a716d5"><div class="ttname"><a href="classdhcp_1_1_c_s_v_database.html#afe747abe2434e051adb3f2d682a716d5">dhcp.CSVDatabase.file</a></div><div class="ttdeci">def file(self, mode='r')</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00409">dhcp.py:409</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html">dhcp.DHCPServerConfiguration</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00294">dhcp.py:294</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a180484ac4bdf23fc07407d3b44f722cc"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a180484ac4bdf23fc07407d3b44f722cc">dhcp.DHCPServerConfiguration.load</a></div><div class="ttdeci">def load(self, file)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00313">dhcp.py:313</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a314df3b0d50a13968153f317cfac2ee2"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a314df3b0d50a13968153f317cfac2ee2">dhcp.DHCPServerConfiguration.broadcast_address</a></div><div class="ttdeci">broadcast_address</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00337">dhcp.py:337</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a4296295b495ecc82f6646516017ff2cc"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a4296295b495ecc82f6646516017ff2cc">dhcp.DHCPServerConfiguration.subnet_mask</a></div><div class="ttdeci">string subnet_mask</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00303">dhcp.py:303</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a55b1c1ae7a00c76da1ed7ce2a1f12bf9"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a55b1c1ae7a00c76da1ed7ce2a1f12bf9">dhcp.DHCPServerConfiguration.router</a></div><div class="ttdeci">router</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00304">dhcp.py:304</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a59a4bfcf49842e7453ba71412d7e9abf"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a59a4bfcf49842e7453ba71412d7e9abf">dhcp.DHCPServerConfiguration.all_ip_addresses</a></div><div class="ttdeci">def all_ip_addresses(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00342">dhcp.py:342</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a7a5fc60105c8d57601ec948d7d43c8fa"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a7a5fc60105c8d57601ec948d7d43c8fa">dhcp.DHCPServerConfiguration.adjust_if_this_computer_is_a_router</a></div><div class="ttdeci">def adjust_if_this_computer_is_a_router(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00328">dhcp.py:328</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a8dfb7835e513433b9ec1bb29f380e34a"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8dfb7835e513433b9ec1bb29f380e34a">dhcp.DHCPServerConfiguration.domain_name_server</a></div><div class="ttdeci">domain_name_server</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00307">dhcp.py:307</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_a8ec5462f74c8fa19621e0c4d0edfb843"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#a8ec5462f74c8fa19621e0c4d0edfb843">dhcp.DHCPServerConfiguration.network</a></div><div class="ttdeci">string network</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00301">dhcp.py:301</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_aa1e71c8f12e8968a8da7a5779da19f7c"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#aa1e71c8f12e8968a8da7a5779da19f7c">dhcp.DHCPServerConfiguration.network_filter</a></div><div class="ttdeci">def network_filter(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00348">dhcp.py:348</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_aa58cf42f87609209ddce0173b45322c9"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#aa58cf42f87609209ddce0173b45322c9">dhcp.DHCPServerConfiguration.broadcast_address</a></div><div class="ttdeci">string broadcast_address</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00302">dhcp.py:302</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_configuration_html_ad55c5454a6b02e892124f9ef3e3617ab"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server_configuration.html#ad55c5454a6b02e892124f9ef3e3617ab">dhcp.DHCPServerConfiguration.network</a></div><div class="ttdeci">network</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00336">dhcp.py:336</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html">dhcp.DHCPServer</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00519">dhcp.py:519</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a09717723751aecefc6ead6efb43bfe27"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a09717723751aecefc6ead6efb43bfe27">dhcp.DHCPServer.is_valid_client_address</a></div><div class="ttdeci">def is_valid_client_address(self, address)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00575">dhcp.py:575</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a0c3ee14aec5d0474ac6cc370c5347795"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a0c3ee14aec5d0474ac6cc370c5347795">dhcp.DHCPServer.server_identifiers</a></div><div class="ttdeci">def server_identifiers(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00618">dhcp.py:618</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a1270c39efab736e13b4645adccb5d445"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a1270c39efab736e13b4645adccb5d445">dhcp.DHCPServer.update</a></div><div class="ttdeci">def update(self, timeout=0)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00545">dhcp.py:545</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a29aa89ca8607f78da17e3585866c0cf9"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a29aa89ca8607f78da17e3585866c0cf9">dhcp.DHCPServer.time_started</a></div><div class="ttdeci">time_started</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00536">dhcp.py:536</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a60d24347513562e332a247704d0d3ff8"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a60d24347513562e332a247704d0d3ff8">dhcp.DHCPServer.run_in_thread</a></div><div class="ttdeci">def run_in_thread(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00645">dhcp.py:645</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a613a716546dae583db2f813414a34f2b"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a613a716546dae583db2f813414a34f2b">dhcp.DHCPServer.client_has_chosen</a></div><div class="ttdeci">def client_has_chosen(self, packet)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00568">dhcp.py:568</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a657300b76aa268c81976de4ffcbc0644"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a657300b76aa268c81976de4ffcbc0644">dhcp.DHCPServer.broadcast</a></div><div class="ttdeci">def broadcast(self, packet)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00621">dhcp.py:621</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a664b45ac7c71967fd415966f2ba5ab4d"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a664b45ac7c71967fd415966f2ba5ab4d">dhcp.DHCPServer.hosts</a></div><div class="ttdeci">hosts</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00535">dhcp.py:535</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a67a29068f2ed30839ae9d136abbe2c89"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a67a29068f2ed30839ae9d136abbe2c89">dhcp.DHCPServer.transactions</a></div><div class="ttdeci">transactions</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00534">dhcp.py:534</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a7a509c96ae764cd0bd9bd8e84ee23562"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a7a509c96ae764cd0bd9bd8e84ee23562">dhcp.DHCPServer.get_all_hosts</a></div><div class="ttdeci">def get_all_hosts(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00656">dhcp.py:656</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_a93516cbbbd270d873698bbe13dbd3520"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#a93516cbbbd270d873698bbe13dbd3520">dhcp.DHCPServer.socket</a></div><div class="ttdeci">socket</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00529">dhcp.py:529</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_aae6fca0bb91de82b090278a45bb5634f"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#aae6fca0bb91de82b090278a45bb5634f">dhcp.DHCPServer.__init__</a></div><div class="ttdeci">def __init__(self, configuration=None)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00523">dhcp.py:523</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_aaf1568a67cd2ba6132c412f664e72ca1"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#aaf1568a67cd2ba6132c412f664e72ca1">dhcp.DHCPServer.debug_clients</a></div><div class="ttdeci">def debug_clients(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00650">dhcp.py:650</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_ab35d34adc3b6c6b820eacae82dfb7361"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#ab35d34adc3b6c6b820eacae82dfb7361">dhcp.DHCPServer.close</a></div><div class="ttdeci">def close(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00538">dhcp.py:538</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_ac2c06166394c431fdf45fac68a95a23c"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#ac2c06166394c431fdf45fac68a95a23c">dhcp.DHCPServer.closed</a></div><div class="ttdeci">closed</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00533">dhcp.py:533</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_ad0abc95458235a7300991d9111c49869"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#ad0abc95458235a7300991d9111c49869">dhcp.DHCPServer.get_ip_address</a></div><div class="ttdeci">def get_ip_address(self, packet)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00583">dhcp.py:583</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_ad0db4a8937934f994c6bf861873dc8b9"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#ad0db4a8937934f994c6bf861873dc8b9">dhcp.DHCPServer.delay_worker</a></div><div class="ttdeci">delay_worker</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00532">dhcp.py:532</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_ad2c9c6bac9f72b52c9be75cb1a0477b2"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#ad2c9c6bac9f72b52c9be75cb1a0477b2">dhcp.DHCPServer.configuration</a></div><div class="ttdeci">configuration</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00527">dhcp.py:527</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_ad4d593daddb6f818f3b8aa2240dc1cb5"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#ad4d593daddb6f818f3b8aa2240dc1cb5">dhcp.DHCPServer.received</a></div><div class="ttdeci">def received(self, packet)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00564">dhcp.py:564</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_ada6bcaad1d88519fd7086a442ed998e1"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#ada6bcaad1d88519fd7086a442ed998e1">dhcp.DHCPServer.get_current_hosts</a></div><div class="ttdeci">def get_current_hosts(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00659">dhcp.py:659</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_server_html_af7a2d659dc19642dbfd3838982491f53"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_server.html#af7a2d659dc19642dbfd3838982491f53">dhcp.DHCPServer.run</a></div><div class="ttdeci">def run(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00636">dhcp.py:636</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html">dhcp.DHCPTransaction</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00193">dhcp.py:193</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a01f7133e90ff9e9f4171156043e97d24"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a01f7133e90ff9e9f4171156043e97d24">dhcp.DHCPTransaction.received_dhcp_discover</a></div><div class="ttdeci">def received_dhcp_discover(self, discovery)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00233">dhcp.py:233</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a3902197353a4c20c0dcac8526f78135c"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a3902197353a4c20c0dcac8526f78135c">dhcp.DHCPTransaction.send_offer</a></div><div class="ttdeci">def send_offer(self, discovery)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00240">dhcp.py:240</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a3ed98b3b86d150574fa4f89e8932050b"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a3ed98b3b86d150574fa4f89e8932050b">dhcp.DHCPTransaction.close</a></div><div class="ttdeci">def close(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00212">dhcp.py:212</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a597990e446406ab5b466873cb26d3401"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a597990e446406ab5b466873cb26d3401">dhcp.DHCPTransaction.received_dhcp_request</a></div><div class="ttdeci">def received_dhcp_request(self, request)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00260">dhcp.py:260</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a688bb4dff2fdd13482813e0d4daf0519"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a688bb4dff2fdd13482813e0d4daf0519">dhcp.DHCPTransaction.received_dhcp_inform</a></div><div class="ttdeci">def received_dhcp_inform(self, inform)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00287">dhcp.py:287</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a72d82d13ccf4afc9b426844aaf0aa4a3"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a72d82d13ccf4afc9b426844aaf0aa4a3">dhcp.DHCPTransaction.debug</a></div><div class="ttdeci">debug</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00205">dhcp.py:205</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a816612f54eb1d0f9b6281c06f00442b7"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a816612f54eb1d0f9b6281c06f00442b7">dhcp.DHCPTransaction.done_time</a></div><div class="ttdeci">done_time</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00202">dhcp.py:202</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a84787d49ed1d39194315546d1b203be1"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a84787d49ed1d39194315546d1b203be1">dhcp.DHCPTransaction.acknowledge</a></div><div class="ttdeci">def acknowledge(self, request)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00269">dhcp.py:269</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_a9b45fff7092b26fce7b3275c015ba4bf"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#a9b45fff7092b26fce7b3275c015ba4bf">dhcp.DHCPTransaction.done</a></div><div class="ttdeci">done</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00203">dhcp.py:203</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_aa6b4d1ca986f35009cc226a6b33f1334"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#aa6b4d1ca986f35009cc226a6b33f1334">dhcp.DHCPTransaction.__init__</a></div><div class="ttdeci">def __init__(self, server)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00196">dhcp.py:196</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_aab72d52c388de5e42435f000c82a2b3b"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#aab72d52c388de5e42435f000c82a2b3b">dhcp.DHCPTransaction.configuration</a></div><div class="ttdeci">configuration</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00200">dhcp.py:200</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_aae31911f51f293161e55bcb8b2053f01"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#aae31911f51f293161e55bcb8b2053f01">dhcp.DHCPTransaction.receive</a></div><div class="ttdeci">def receive(self, packet)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00217">dhcp.py:217</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_ab34941515e9c6acbb985aeef4b26c20f"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#ab34941515e9c6acbb985aeef4b26c20f">dhcp.DHCPTransaction.packets</a></div><div class="ttdeci">packets</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00201">dhcp.py:201</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_ac258510a5d3bdb1b0e5eaeb567c57532"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#ac258510a5d3bdb1b0e5eaeb567c57532">dhcp.DHCPTransaction.server</a></div><div class="ttdeci">server</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00199">dhcp.py:199</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_af4c5e3b25264df622a86463f2a581e41"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#af4c5e3b25264df622a86463f2a581e41">dhcp.DHCPTransaction.do_after</a></div><div class="ttdeci">do_after</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00204">dhcp.py:204</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_d_h_c_p_transaction_html_af53ca7186575ad528aa4a0698fd9cbb7"><div class="ttname"><a href="classdhcp_1_1_d_h_c_p_transaction.html#af53ca7186575ad528aa4a0698fd9cbb7">dhcp.DHCPTransaction.is_done</a></div><div class="ttdeci">def is_done(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00207">dhcp.py:207</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_g_r_e_a_t_e_r_html"><div class="ttname"><a href="classdhcp_1_1_g_r_e_a_t_e_r.html">dhcp.GREATER</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00370">dhcp.py:370</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_g_r_e_a_t_e_r_html_a6c283efcaf3815abb7121061f45b4332"><div class="ttname"><a href="classdhcp_1_1_g_r_e_a_t_e_r.html#a6c283efcaf3815abb7121061f45b4332">dhcp.GREATER.__init__</a></div><div class="ttdeci">def __init__(self, value)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00373">dhcp.py:373</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_g_r_e_a_t_e_r_html_a904d88008338389f183032d0e996f3c1"><div class="ttname"><a href="classdhcp_1_1_g_r_e_a_t_e_r.html#a904d88008338389f183032d0e996f3c1">dhcp.GREATER.__eq__</a></div><div class="ttdeci">def __eq__(self, other)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00375">dhcp.py:375</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_g_r_e_a_t_e_r_html_ac340b80531a5e54d8ad03059c41c4906"><div class="ttname"><a href="classdhcp_1_1_g_r_e_a_t_e_r.html#ac340b80531a5e54d8ad03059c41c4906">dhcp.GREATER.value</a></div><div class="ttdeci">value</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00374">dhcp.py:374</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html"><div class="ttname"><a href="classdhcp_1_1_host_database.html">dhcp.HostDatabase</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00489">dhcp.py:489</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html_a011b8b19259f5df030e3746c5f751717"><div class="ttname"><a href="classdhcp_1_1_host_database.html#a011b8b19259f5df030e3746c5f751717">dhcp.HostDatabase.delete</a></div><div class="ttdeci">def delete(self, host=None, **kw)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00500">dhcp.py:500</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html_a1bfeeeca3271a5e20a957d41f75be28c"><div class="ttname"><a href="classdhcp_1_1_host_database.html#a1bfeeeca3271a5e20a957d41f75be28c">dhcp.HostDatabase.all</a></div><div class="ttdeci">def all(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00507">dhcp.py:507</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html_a392bba3af76de29a6bf8314c15fb298e"><div class="ttname"><a href="classdhcp_1_1_host_database.html#a392bba3af76de29a6bf8314c15fb298e">dhcp.HostDatabase.get</a></div><div class="ttdeci">def get(self, **kw)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00493">dhcp.py:493</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html_a54e5a7e7e3d9479470b7c3c103ea052c"><div class="ttname"><a href="classdhcp_1_1_host_database.html#a54e5a7e7e3d9479470b7c3c103ea052c">dhcp.HostDatabase.replace</a></div><div class="ttdeci">def replace(self, host)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00510">dhcp.py:510</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html_aaf801ca6318cd6092aff4564e22665f0"><div class="ttname"><a href="classdhcp_1_1_host_database.html#aaf801ca6318cd6092aff4564e22665f0">dhcp.HostDatabase.__init__</a></div><div class="ttdeci">def __init__(self, file_name)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00490">dhcp.py:490</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html_ad10f58a0a7ec720fbf530c9b0fb98058"><div class="ttname"><a href="classdhcp_1_1_host_database.html#ad10f58a0a7ec720fbf530c9b0fb98058">dhcp.HostDatabase.db</a></div><div class="ttdeci">db</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00491">dhcp.py:491</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_database_html_afbf9e7255243735d446d69da9ad01b95"><div class="ttname"><a href="classdhcp_1_1_host_database.html#afbf9e7255243735d446d69da9ad01b95">dhcp.HostDatabase.add</a></div><div class="ttdeci">def add(self, host)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00497">dhcp.py:497</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html"><div class="ttname"><a href="classdhcp_1_1_host.html">dhcp.Host</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00442">dhcp.py:442</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_a221af5247505072a9ca2223025377756"><div class="ttname"><a href="classdhcp_1_1_host.html#a221af5247505072a9ca2223025377756">dhcp.Host.__hash__</a></div><div class="ttdeci">def __hash__(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00478">dhcp.py:478</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_a287287e62149143af68711e7c1617282"><div class="ttname"><a href="classdhcp_1_1_host.html#a287287e62149143af68711e7c1617282">dhcp.Host.has_valid_ip</a></div><div class="ttdeci">def has_valid_ip(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00484">dhcp.py:484</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_a45ba91c0afcceeb3a7a3370aab91dc0f"><div class="ttname"><a href="classdhcp_1_1_host.html#a45ba91c0afcceeb3a7a3370aab91dc0f">dhcp.Host.from_tuple</a></div><div class="ttdeci">def from_tuple(cls, line)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00452">dhcp.py:452</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_a4db1cd4ba6cae9480967587ed4b26b95"><div class="ttname"><a href="classdhcp_1_1_host.html#a4db1cd4ba6cae9480967587ed4b26b95">dhcp.Host.hostname</a></div><div class="ttdeci">hostname</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00448">dhcp.py:448</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_a65e90f26bd53e4484d53f82b0b8b3bc8"><div class="ttname"><a href="classdhcp_1_1_host.html#a65e90f26bd53e4484d53f82b0b8b3bc8">dhcp.Host.from_packet</a></div><div class="ttdeci">def from_packet(cls, packet)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00458">dhcp.py:458</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_a700da84969feda66ac68f7214fa3b113"><div class="ttname"><a href="classdhcp_1_1_host.html#a700da84969feda66ac68f7214fa3b113">dhcp.Host.to_pattern</a></div><div class="ttdeci">def to_pattern(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00473">dhcp.py:473</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_a90055429ec7c36129ea44d6f9e2f45a7"><div class="ttname"><a href="classdhcp_1_1_host.html#a90055429ec7c36129ea44d6f9e2f45a7">dhcp.Host.get_pattern</a></div><div class="ttdeci">def get_pattern(mac=ALL, ip=ALL, hostname=ALL, last_used=ALL)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00465">dhcp.py:465</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_aabc84008d42981a5c7c2e8322bd8b5f4"><div class="ttname"><a href="classdhcp_1_1_host.html#aabc84008d42981a5c7c2e8322bd8b5f4">dhcp.Host.mac</a></div><div class="ttdeci">mac</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00446">dhcp.py:446</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_ab0ad131caf3688fda7ec3246d3a919aa"><div class="ttname"><a href="classdhcp_1_1_host.html#ab0ad131caf3688fda7ec3246d3a919aa">dhcp.Host.__init__</a></div><div class="ttdeci">def __init__(self, mac, ip, hostname, last_used)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00445">dhcp.py:445</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_adcf88164490fe575a9f220d3b37d5fff"><div class="ttname"><a href="classdhcp_1_1_host.html#adcf88164490fe575a9f220d3b37d5fff">dhcp.Host.__eq__</a></div><div class="ttdeci">def __eq__(self, other)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00481">dhcp.py:481</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_aecf59068c5829a6fc9bfe52f35a33391"><div class="ttname"><a href="classdhcp_1_1_host.html#aecf59068c5829a6fc9bfe52f35a33391">dhcp.Host.ip</a></div><div class="ttdeci">ip</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00447">dhcp.py:447</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_aee6d734c3a4608ebc899f14efce36ff0"><div class="ttname"><a href="classdhcp_1_1_host.html#aee6d734c3a4608ebc899f14efce36ff0">dhcp.Host.last_used</a></div><div class="ttdeci">last_used</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00449">dhcp.py:449</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_host_html_af4101aa3d505fb12742083f2268b0aaa"><div class="ttname"><a href="classdhcp_1_1_host.html#af4101aa3d505fb12742083f2268b0aaa">dhcp.Host.to_tuple</a></div><div class="ttdeci">def to_tuple(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00468">dhcp.py:468</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_n_e_t_w_o_r_k_html"><div class="ttname"><a href="classdhcp_1_1_n_e_t_w_o_r_k.html">dhcp.NETWORK</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00378">dhcp.py:378</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_n_e_t_w_o_r_k_html_a0389879d6d5493763fd15a6a6c18a73d"><div class="ttname"><a href="classdhcp_1_1_n_e_t_w_o_r_k.html#a0389879d6d5493763fd15a6a6c18a73d">dhcp.NETWORK.network</a></div><div class="ttdeci">network</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00383">dhcp.py:383</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_n_e_t_w_o_r_k_html_aad7fdb6b11bad9cb44e9d35b00e97631"><div class="ttname"><a href="classdhcp_1_1_n_e_t_w_o_r_k.html#aad7fdb6b11bad9cb44e9d35b00e97631">dhcp.NETWORK.__init__</a></div><div class="ttdeci">def __init__(self, network, subnet_mask)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00381">dhcp.py:381</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_n_e_t_w_o_r_k_html_ab2aa1dd0d3ed83f1eb87deadc60f200f"><div class="ttname"><a href="classdhcp_1_1_n_e_t_w_o_r_k.html#ab2aa1dd0d3ed83f1eb87deadc60f200f">dhcp.NETWORK.__eq__</a></div><div class="ttdeci">def __eq__(self, other)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00384">dhcp.py:384</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_n_e_t_w_o_r_k_html_af96eacbe29f44b963ba8e1553b9a5412"><div class="ttname"><a href="classdhcp_1_1_n_e_t_w_o_r_k.html#af96eacbe29f44b963ba8e1553b9a5412">dhcp.NETWORK.subnet_mask</a></div><div class="ttdeci">subnet_mask</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00382">dhcp.py:382</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_priority_queue_html"><div class="ttname"><a href="classdhcp_1_1_priority_queue.html">dhcp.PriorityQueue</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00064">dhcp.py:64</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_priority_queue_html_a6a52ec70f226bbb5c32ab8ac85dbad95"><div class="ttname"><a href="classdhcp_1_1_priority_queue.html#a6a52ec70f226bbb5c32ab8ac85dbad95">dhcp.PriorityQueue._queue</a></div><div class="ttdeci">_queue</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00069">dhcp.py:69</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_priority_queue_html_a784952c04d9144e3d1521b377609daee"><div class="ttname"><a href="classdhcp_1_1_priority_queue.html#a784952c04d9144e3d1521b377609daee">dhcp.PriorityQueue._index</a></div><div class="ttdeci">_index</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00070">dhcp.py:70</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_priority_queue_html_a790eb940b494728bc6753ddf3febc513"><div class="ttname"><a href="classdhcp_1_1_priority_queue.html#a790eb940b494728bc6753ddf3febc513">dhcp.PriorityQueue.__init__</a></div><div class="ttdeci">def __init__(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00068">dhcp.py:68</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_priority_queue_html_ac1073e720d4edd4f4eb220e86421bc9d"><div class="ttname"><a href="classdhcp_1_1_priority_queue.html#ac1073e720d4edd4f4eb220e86421bc9d">dhcp.PriorityQueue.get</a></div><div class="ttdeci">def get(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00076">dhcp.py:76</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_priority_queue_html_af0f906a4edcc884001a82593805432b1"><div class="ttname"><a href="classdhcp_1_1_priority_queue.html#af0f906a4edcc884001a82593805432b1">dhcp.PriorityQueue.qsize</a></div><div class="ttdeci">def qsize(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00079">dhcp.py:79</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_priority_queue_html_afd1fdf4e96d3c3dde2a05113e161728c"><div class="ttname"><a href="classdhcp_1_1_priority_queue.html#afd1fdf4e96d3c3dde2a05113e161728c">dhcp.PriorityQueue.put</a></div><div class="ttdeci">def put(self, item)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00072">dhcp.py:72</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_request_handler_html"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_request_handler.html">dhcp.ThreadedTCPRequestHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00662">dhcp.py:662</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_request_handler_html_ac78a14e22d2de9aece1eb569821bed03"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_request_handler.html#ac78a14e22d2de9aece1eb569821bed03">dhcp.ThreadedTCPRequestHandler.handle</a></div><div class="ttdeci">def handle(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00665">dhcp.py:665</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_server_html"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_server.html">dhcp.ThreadedTCPServer</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00696">dhcp.py:696</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_server_html_a00e40b47cf0258fec5fdac38fec70289"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_server.html#a00e40b47cf0258fec5fdac38fec70289">dhcp.ThreadedTCPServer.setHosts</a></div><div class="ttdeci">def setHosts(self, data)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00704">dhcp.py:704</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_server_html_a20dc710a5b965b91777ceff69a9bbb66"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_server.html#a20dc710a5b965b91777ceff69a9bbb66">dhcp.ThreadedTCPServer.configuration</a></div><div class="ttdeci">configuration</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00712">dhcp.py:712</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_server_html_a298bdccf761c349e340b27db1865ac2f"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_server.html#a298bdccf761c349e340b27db1865ac2f">dhcp.ThreadedTCPServer.setEvents</a></div><div class="ttdeci">def setEvents(self, data)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00699">dhcp.py:699</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_server_html_a895afba96fa627cb796c4b5a14d3f73c"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_server.html#a895afba96fa627cb796c4b5a14d3f73c">dhcp.ThreadedTCPServer.hosts</a></div><div class="ttdeci">hosts</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00707">dhcp.py:707</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_server_html_ac46a680f92c5fa91de9103ba9ee4f1f1"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_server.html#ac46a680f92c5fa91de9103ba9ee4f1f1">dhcp.ThreadedTCPServer.setConfiguration</a></div><div class="ttdeci">def setConfiguration(self, data)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00709">dhcp.py:709</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_threaded_t_c_p_server_html_aeb5515a34e31d53dca8459bb79e034d6"><div class="ttname"><a href="classdhcp_1_1_threaded_t_c_p_server.html#aeb5515a34e31d53dca8459bb79e034d6">dhcp.ThreadedTCPServer.events</a></div><div class="ttdeci">events</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00702">dhcp.py:702</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html">dhcp.TransactionDelayWorker</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00020">dhcp.py:20</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html_a06c68f50041b6e9e949c6e87fe1d370b"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html#a06c68f50041b6e9e949c6e87fe1d370b">dhcp.TransactionDelayWorker.queue</a></div><div class="ttdeci">queue</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00027">dhcp.py:27</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html_a2581fd14007f440528591686e05a6f36"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html#a2581fd14007f440528591686e05a6f36">dhcp.TransactionDelayWorker.do_after</a></div><div class="ttdeci">def do_after(self, seconds, func, args=(), kw={})</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00048">dhcp.py:48</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html_a6db48dc0f86e3fa546936d02ec8ed2b8"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html#a6db48dc0f86e3fa546936d02ec8ed2b8">dhcp.TransactionDelayWorker.__init__</a></div><div class="ttdeci">def __init__(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00023">dhcp.py:23</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html_a7994f56d4451c2c7880ecbcb13297ef7"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html#a7994f56d4451c2c7880ecbcb13297ef7">dhcp.TransactionDelayWorker._delay_response_thread</a></div><div class="ttdeci">def _delay_response_thread(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00031">dhcp.py:31</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html_a88b591aba959ea71f576bd27c3c23f41"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html#a88b591aba959ea71f576bd27c3c23f41">dhcp.TransactionDelayWorker.closed</a></div><div class="ttdeci">closed</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00026">dhcp.py:26</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html_ab46086ae177f9f76c790277c8dc09f9b"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html#ab46086ae177f9f76c790277c8dc09f9b">dhcp.TransactionDelayWorker.close</a></div><div class="ttdeci">def close(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00054">dhcp.py:54</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_transaction_delay_worker_html_acccc4ffe57c17795cba2691c3759fcd8"><div class="ttname"><a href="classdhcp_1_1_transaction_delay_worker.html#acccc4ffe57c17795cba2691c3759fcd8">dhcp.TransactionDelayWorker.thread</a></div><div class="ttdeci">thread</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00028">dhcp.py:28</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html">dhcp.WriteBootProtocolPacket</a></div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00082">dhcp.py:82</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a04195f0af2bc134ac398a11227af4b16"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a04195f0af2bc134ac398a11227af4b16">dhcp.WriteBootProtocolPacket.__init__</a></div><div class="ttdeci">def __init__(self, configuration)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00107">dhcp.py:107</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a1eb459ed259bff6617085971eb31361c"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a1eb459ed259bff6617085971eb31361c">dhcp.WriteBootProtocolPacket.options</a></div><div class="ttdeci">def options(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00167">dhcp.py:167</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a2158cd33033b3ad7b3de5fd0ced0747d"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a2158cd33033b3ad7b3de5fd0ced0747d">dhcp.WriteBootProtocolPacket.bootp_flags</a></div><div class="ttdeci">int bootp_flags</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00095">dhcp.py:95</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a34a75a9fd48929777c6730460b577344"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a34a75a9fd48929777c6730460b577344">dhcp.WriteBootProtocolPacket.seconds_elapsed</a></div><div class="ttdeci">int seconds_elapsed</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00094">dhcp.py:94</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a49c598b664e64b515f80d6f29637e003"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a49c598b664e64b515f80d6f29637e003">dhcp.WriteBootProtocolPacket.hops</a></div><div class="ttdeci">int hops</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00090">dhcp.py:90</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a58a23d7668a529c7e9216228c4cf2ba1"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a58a23d7668a529c7e9216228c4cf2ba1">dhcp.WriteBootProtocolPacket.next_server_ip_address</a></div><div class="ttdeci">string next_server_ip_address</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00099">dhcp.py:99</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a5e78e0ac4f0a7e322a479567bf0ab43c"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a5e78e0ac4f0a7e322a479567bf0ab43c">dhcp.WriteBootProtocolPacket.hardware_address_length</a></div><div class="ttdeci">int hardware_address_length</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00089">dhcp.py:89</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a7833e353ff7adc5f1b8042fcd739c7cd"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a7833e353ff7adc5f1b8042fcd739c7cd">dhcp.WriteBootProtocolPacket.parameter_order</a></div><div class="ttdeci">list parameter_order</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00105">dhcp.py:105</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a7c1eaf3ea98ff19558a2873d47c1bd13"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a7c1eaf3ea98ff19558a2873d47c1bd13">dhcp.WriteBootProtocolPacket.message_type</a></div><div class="ttdeci">int message_type</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00087">dhcp.py:87</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a7c5041840cc7b7f15970bf58be486659"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a7c5041840cc7b7f15970bf58be486659">dhcp.WriteBootProtocolPacket.client_ip_address</a></div><div class="ttdeci">string client_ip_address</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00097">dhcp.py:97</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_a8dadba279ad323c2986da9c8822664ff"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#a8dadba279ad323c2986da9c8822664ff">dhcp.WriteBootProtocolPacket.client_mac_address</a></div><div class="ttdeci">client_mac_address</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00102">dhcp.py:102</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_aab5d8b775b053559511c06cf52949670"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#aab5d8b775b053559511c06cf52949670">dhcp.WriteBootProtocolPacket.get_option</a></div><div class="ttdeci">def get_option(self, option)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00152">dhcp.py:152</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_ab5a5b6937a48e0daa4aae992a247f2d5"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#ab5a5b6937a48e0daa4aae992a247f2d5">dhcp.WriteBootProtocolPacket.magic_cookie</a></div><div class="ttdeci">string magic_cookie</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00103">dhcp.py:103</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_abed6f8fcad62c89ae9f670dd8ce95987"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#abed6f8fcad62c89ae9f670dd8ce95987">dhcp.WriteBootProtocolPacket.your_ip_address</a></div><div class="ttdeci">string your_ip_address</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00098">dhcp.py:98</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_add8bca1f53869d801f62ff51f38ef315"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#add8bca1f53869d801f62ff51f38ef315">dhcp.WriteBootProtocolPacket.transaction_id</a></div><div class="ttdeci">transaction_id</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00092">dhcp.py:92</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_ae995d022d4c4280c10036f64b271d455"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#ae995d022d4c4280c10036f64b271d455">dhcp.WriteBootProtocolPacket.hardware_type</a></div><div class="ttdeci">int hardware_type</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00088">dhcp.py:88</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_aea12de4e76f8ea2b8c4eb33f4adac9c4"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#aea12de4e76f8ea2b8c4eb33f4adac9c4">dhcp.WriteBootProtocolPacket.__str__</a></div><div class="ttdeci">def __str__(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00188">dhcp.py:188</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_aec59dbba94aedab6025226cb7bf92682"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#aec59dbba94aedab6025226cb7bf92682">dhcp.WriteBootProtocolPacket.relay_agent_ip_address</a></div><div class="ttdeci">string relay_agent_ip_address</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00100">dhcp.py:100</a></div></div>
<div class="ttc" id="aclassdhcp_1_1_write_boot_protocol_packet_html_af902569db8f9c77b0b0bbbbb66c5f98f"><div class="ttname"><a href="classdhcp_1_1_write_boot_protocol_packet.html#af902569db8f9c77b0b0bbbbb66c5f98f">dhcp.WriteBootProtocolPacket.to_bytes</a></div><div class="ttdeci">def to_bytes(self)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00119">dhcp.py:119</a></div></div>
<div class="ttc" id="aclasslistener_1_1_read_boot_protocol_packet_html"><div class="ttname"><a href="classlistener_1_1_read_boot_protocol_packet.html">listener.ReadBootProtocolPacket</a></div><div class="ttdef"><b>Definition:</b> <a href="listener_8py_source.html#l00144">listener.py:144</a></div></div>
<div class="ttc" id="aclassttldict_1_1_t_t_l_ordered_dict_html"><div class="ttname"><a href="classttldict_1_1_t_t_l_ordered_dict.html">ttldict.TTLOrderedDict</a></div><div class="ttdef"><b>Definition:</b> <a href="ttldict_8py_source.html#l00008">ttldict.py:8</a></div></div>
<div class="ttc" id="anamespacedhcp_html_a601bd489973305b2dba2d3dd7ce30ed3"><div class="ttname"><a href="namespacedhcp.html#a601bd489973305b2dba2d3dd7ce30ed3">dhcp.debug_msg</a></div><div class="ttdeci">def debug_msg(msg, type)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00719">dhcp.py:719</a></div></div>
<div class="ttc" id="anamespacedhcp_html_a64ea5198ded3c257ffc75ed83f981755"><div class="ttname"><a href="namespacedhcp.html#a64ea5198ded3c257ffc75ed83f981755">dhcp.debug</a></div><div class="ttdeci">debug</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00729">dhcp.py:729</a></div></div>
<div class="ttc" id="anamespacedhcp_html_ab060cad3f10abaad7ad33123c5118aea"><div class="ttname"><a href="namespacedhcp.html#ab060cad3f10abaad7ad33123c5118aea">dhcp.ip_addresses</a></div><div class="ttdeci">def ip_addresses(network, subnet_mask)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00351">dhcp.py:351</a></div></div>
<div class="ttc" id="anamespacedhcp_html_ab6b61de7bae0d5e51c3e4b753bc48421"><div class="ttname"><a href="namespacedhcp.html#ab6b61de7bae0d5e51c3e4b753bc48421">dhcp.sorted_hosts</a></div><div class="ttdeci">def sorted_hosts(hosts)</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00514">dhcp.py:514</a></div></div>
<div class="ttc" id="anamespacedhcp_html_af20880fd0c047e3357f1c8c239968538"><div class="ttname"><a href="namespacedhcp.html#af20880fd0c047e3357f1c8c239968538">dhcp.get_host_ip_addresses</a></div><div class="ttdeci">def get_host_ip_addresses()</div><div class="ttdef"><b>Definition:</b> <a href="dhcp_8py_source.html#l00059">dhcp.py:59</a></div></div>
<div class="ttc" id="anamespacelistener_html_a15fb8066ece6d815dde7ba6cdb823d57"><div class="ttname"><a href="namespacelistener.html#a15fb8066ece6d815dde7ba6cdb823d57">listener.macpack</a></div><div class="ttdeci">def macpack(mac)</div><div class="ttdef"><b>Definition:</b> <a href="listener_8py_source.html#l00039">listener.py:39</a></div></div>
<div class="ttc" id="anamespacelistener_html_a36ceadb1f7f70fbe13b1d40358555d7a"><div class="ttname"><a href="namespacelistener.html#a36ceadb1f7f70fbe13b1d40358555d7a">listener.shortpack</a></div><div class="ttdeci">shortpack</div><div class="ttdef"><b>Definition:</b> <a href="listener_8py_source.html#l00032">listener.py:32</a></div></div>
<div class="ttc" id="anamespacelistener_html_a5bccea4f84af3a2a57917ff10a721736"><div class="ttname"><a href="namespacelistener.html#a5bccea4f84af3a2a57917ff10a721736">listener.packet</a></div><div class="ttdeci">packet</div><div class="ttdef"><b>Definition:</b> <a href="listener_8py_source.html#l00258">listener.py:258</a></div></div>
<div class="ttc" id="anamespacesocket_html"><div class="ttname"><a href="namespacesocket.html">socket</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dhcp_8py.html">dhcp.py</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
